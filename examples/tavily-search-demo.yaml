version: 1
name: tavily-research-agent
description: |
  AI-powered research agent using Tavily search for optimized, relevant results.
  Tavily provides AI-curated search results with relevance scoring and optional
  AI-generated answers for quick insights.
  
  Requires: TAVILY_API_KEY environment variable
  Get API key at: https://app.tavily.com (1000 free credits monthly)
  
  Run with: strands run tavily-search-demo.yaml --ask

runtime:
  provider: openai
  model_id: gpt-4o-mini

agents:
  researcher:
    prompt: |
      You are an expert research assistant using Tavily AI-powered search.
      
      Tavily provides highly relevant, AI-curated search results with:
      - Relevance scoring (0-1) for each result
      - Clean, extracted content snippets
      - Optional AI-generated answers for quick insights
      
      The tavily_search tool returns JSON with:
      - results: List of search results with title, url, content, and score
      - query: The search query used
      - response_time: Search execution time
      - answer: (optional) AI-generated answer when include_answer=true
      
      When researching:
      1. Start with a focused search query
      2. Review the results sorted by relevance (score)
      3. Use include_answer=true for factual questions
      4. Synthesize information from multiple high-scoring sources
      5. Always cite sources with URLs
      
      Provide clear, well-researched responses with proper attribution.

# Interactive variable prompting - run with --ask flag
inputs:
  required:
    topic:
      type: string
      description: "Topic or question to research"
    
    max_results:
      type: integer
      description: "Number of search results (1-20)"
      
    include_answer:
      type: boolean
      description: "Include AI-generated answer based on results"

pattern:
  type: chain
  config:
    steps:
      - agent: researcher
        input: |
          Research the following topic using Tavily search: {{ topic }}
          
          Search parameters:
          - max_results: {{ max_results }}
          - include_answer: {{ include_answer }}
          
          {% if include_answer %}
          Review the AI-generated answer first for a quick overview,
          then examine the individual search results for deeper insights.
          {% else %}
          Examine the search results carefully, prioritizing those with
          higher relevance scores (closer to 1.0).
          {% endif %}
          
          Provide a comprehensive summary that:
          1. Synthesizes information from the most relevant sources
          2. Includes key facts and insights
          3. Cites specific sources with URLs
          4. Notes the relevance scores of cited sources
          
          Focus on accuracy and clarity.

tools:
  python:
    - tavily_search  # Native Tavily AI-powered search tool

outputs:
  artifacts:
    - path: "./tavily-results.md"
      from: |
        # Research Report: {{ topic }}
        
        **Search Parameters:**
        - Max Results: {{ max_results }}
        - Include AI Answer: {{ include_answer }}
        
        ---
        
        ## Research Findings
        
        {{ last_response }}
        
        ---
        
        *Powered by Tavily AI Search*
        *Generated by Strands CLI*
