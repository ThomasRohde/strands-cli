<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="DAG-based parallel task execution with dependencies"><meta name=author content="Thomas Klok Rohde"><link href=https://thomasrohde.github.io/strands-cli/v0.5/howto/patterns/workflow/ rel=canonical><link href=../chain/ rel=prev><link href=../routing/ rel=next><link rel=icon href=../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.3"><title>Workflow Pattern - Strands CLI</title><link rel=stylesheet href=../../../assets/stylesheets/main.d7758b05.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../assets/_mkdocstrings.css><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#workflow-pattern class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title="Strands CLI" class="md-header__button md-logo" aria-label="Strands CLI" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Strands CLI </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Workflow Pattern </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/ThomasRohde/strands-cli title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> ThomasRohde/strands-cli </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../../tutorials/quickstart-ollama/ class=md-tabs__link> Tutorials </a> </li> <li class=md-tabs__item> <a href=../../../reference/examples/ class=md-tabs__link> Examples </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../../../explanation/patterns/ class=md-tabs__link> Patterns </a> </li> <li class=md-tabs__item> <a href=../../validate-workflows/ class=md-tabs__link> How-To </a> </li> <li class=md-tabs__item> <a href=../../../explanation/architecture/ class=md-tabs__link> Explanation </a> </li> <li class=md-tabs__item> <a href=../../../reference/cli/ class=md-tabs__link> Reference </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title="Strands CLI" class="md-nav__button md-logo" aria-label="Strands CLI" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> Strands CLI </label> <div class=md-nav__source> <a href=https://github.com/ThomasRohde/strands-cli title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> ThomasRohde/strands-cli </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Tutorials </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Tutorials </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../tutorials/quickstart-ollama/ class=md-nav__link> <span class=md-ellipsis> Quickstart (Ollama) </span> </a> </li> <li class=md-nav__item> <a href=../../../tutorials/quickstart-bedrock/ class=md-nav__link> <span class=md-ellipsis> Quickstart (Bedrock) </span> </a> </li> <li class=md-nav__item> <a href=../../../tutorials/quickstart-openai/ class=md-nav__link> <span class=md-ellipsis> Quickstart (OpenAI) </span> </a> </li> <li class=md-nav__item> <a href=../../../tutorials/first-multi-step/ class=md-nav__link> <span class=md-ellipsis> First Multi-Step Workflow </span> </a> </li> <li class=md-nav__item> <a href=../../../tutorials/builder-api/ class=md-nav__link> <span class=md-ellipsis> Building Workflows with Code </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../reference/examples/ class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4 checked> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex> <span class=md-ellipsis> Patterns </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=true> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Patterns </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../explanation/patterns/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../chain/ class=md-nav__link> <span class=md-ellipsis> Chain </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Workflow </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Workflow </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#when-to-use class=md-nav__link> <span class=md-ellipsis> When to Use </span> </a> </li> <li class=md-nav__item> <a href=#basic-example class=md-nav__link> <span class=md-ellipsis> Basic Example </span> </a> </li> <li class=md-nav__item> <a href=#task-dependencies class=md-nav__link> <span class=md-ellipsis> Task Dependencies </span> </a> <nav class=md-nav aria-label="Task Dependencies"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#no-dependencies-root-tasks class=md-nav__link> <span class=md-ellipsis> No Dependencies (Root Tasks) </span> </a> </li> <li class=md-nav__item> <a href=#single-dependency class=md-nav__link> <span class=md-ellipsis> Single Dependency </span> </a> </li> <li class=md-nav__item> <a href=#multiple-dependencies class=md-nav__link> <span class=md-ellipsis> Multiple Dependencies </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#accessing-task-results class=md-nav__link> <span class=md-ellipsis> Accessing Task Results </span> </a> <nav class=md-nav aria-label="Accessing Task Results"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#specific-task-outputs class=md-nav__link> <span class=md-ellipsis> Specific Task Outputs </span> </a> </li> <li class=md-nav__item> <a href=#task-metadata class=md-nav__link> <span class=md-ellipsis> Task Metadata </span> </a> </li> <li class=md-nav__item> <a href=#iterating-over-tasks class=md-nav__link> <span class=md-ellipsis> Iterating Over Tasks </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#parallel-execution class=md-nav__link> <span class=md-ellipsis> Parallel Execution </span> </a> <nav class=md-nav aria-label="Parallel Execution"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#controlling-concurrency class=md-nav__link> <span class=md-ellipsis> Controlling Concurrency </span> </a> </li> <li class=md-nav__item> <a href=#example-fan-outfan-in class=md-nav__link> <span class=md-ellipsis> Example: Fan-Out/Fan-In </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#dag-execution-order class=md-nav__link> <span class=md-ellipsis> DAG Execution Order </span> </a> <nav class=md-nav aria-label="DAG Execution Order"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#example-execution-timeline class=md-nav__link> <span class=md-ellipsis> Example Execution Timeline </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#advanced-features class=md-nav__link> <span class=md-ellipsis> Advanced Features </span> </a> <nav class=md-nav aria-label="Advanced Features"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#task-descriptions class=md-nav__link> <span class=md-ellipsis> Task Descriptions </span> </a> </li> <li class=md-nav__item> <a href=#conditional-task-content class=md-nav__link> <span class=md-ellipsis> Conditional Task Content </span> </a> </li> <li class=md-nav__item> <a href=#different-agents-per-task class=md-nav__link> <span class=md-ellipsis> Different Agents Per Task </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#error-handling class=md-nav__link> <span class=md-ellipsis> Error Handling </span> </a> <nav class=md-nav aria-label="Error Handling"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#task-failure-behavior class=md-nav__link> <span class=md-ellipsis> Task Failure Behavior </span> </a> </li> <li class=md-nav__item> <a href=#retry-configuration class=md-nav__link> <span class=md-ellipsis> Retry Configuration </span> </a> </li> <li class=md-nav__item> <a href=#budget-limits class=md-nav__link> <span class=md-ellipsis> Budget Limits </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#output-artifacts class=md-nav__link> <span class=md-ellipsis> Output Artifacts </span> </a> <nav class=md-nav aria-label="Output Artifacts"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#accessing-task-results_1 class=md-nav__link> <span class=md-ellipsis> Accessing Task Results </span> </a> </li> <li class=md-nav__item> <a href=#using-last-response class=md-nav__link> <span class=md-ellipsis> Using Last Response </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#best-practices class=md-nav__link> <span class=md-ellipsis> Best Practices </span> </a> <nav class=md-nav aria-label="Best Practices"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-design-for-parallelism class=md-nav__link> <span class=md-ellipsis> 1. Design for Parallelism </span> </a> </li> <li class=md-nav__item> <a href=#2-set-appropriate-max_parallel class=md-nav__link> <span class=md-ellipsis> 2. Set Appropriate max_parallel </span> </a> </li> <li class=md-nav__item> <a href=#3-use-descriptive-task-ids class=md-nav__link> <span class=md-ellipsis> 3. Use Descriptive Task IDs </span> </a> </li> <li class=md-nav__item> <a href=#4-validate-dag-structure class=md-nav__link> <span class=md-ellipsis> 4. Validate DAG Structure </span> </a> </li> <li class=md-nav__item> <a href=#5-manage-context-size class=md-nav__link> <span class=md-ellipsis> 5. Manage Context Size </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#common-patterns class=md-nav__link> <span class=md-ellipsis> Common Patterns </span> </a> <nav class=md-nav aria-label="Common Patterns"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#linear-pipeline-sequential class=md-nav__link> <span class=md-ellipsis> Linear Pipeline (Sequential) </span> </a> </li> <li class=md-nav__item> <a href=#diamond-pattern class=md-nav__link> <span class=md-ellipsis> Diamond Pattern </span> </a> </li> <li class=md-nav__item> <a href=#multi-stage-pipeline class=md-nav__link> <span class=md-ellipsis> Multi-Stage Pipeline </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#performance-considerations class=md-nav__link> <span class=md-ellipsis> Performance Considerations </span> </a> <nav class=md-nav aria-label="Performance Considerations"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#task-scheduling-overhead class=md-nav__link> <span class=md-ellipsis> Task Scheduling Overhead </span> </a> </li> <li class=md-nav__item> <a href=#agent-caching class=md-nav__link> <span class=md-ellipsis> Agent Caching </span> </a> </li> <li class=md-nav__item> <a href=#optimal-parallelism class=md-nav__link> <span class=md-ellipsis> Optimal Parallelism </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#troubleshooting class=md-nav__link> <span class=md-ellipsis> Troubleshooting </span> </a> <nav class=md-nav aria-label=Troubleshooting> <ul class=md-nav__list> <li class=md-nav__item> <a href=#workflow-not-completing class=md-nav__link> <span class=md-ellipsis> Workflow Not Completing </span> </a> </li> <li class=md-nav__item> <a href=#tasks-not-running-in-parallel class=md-nav__link> <span class=md-ellipsis> Tasks Not Running in Parallel </span> </a> </li> <li class=md-nav__item> <a href=#budget-exceeded class=md-nav__link> <span class=md-ellipsis> Budget Exceeded </span> </a> </li> <li class=md-nav__item> <a href=#task-failures class=md-nav__link> <span class=md-ellipsis> Task Failures </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#workflow-vs-other-patterns class=md-nav__link> <span class=md-ellipsis> Workflow vs. Other Patterns </span> </a> <nav class=md-nav aria-label="Workflow vs. Other Patterns"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#workflow-vs-chain class=md-nav__link> <span class=md-ellipsis> Workflow vs. Chain </span> </a> </li> <li class=md-nav__item> <a href=#workflow-vs-parallel class=md-nav__link> <span class=md-ellipsis> Workflow vs. Parallel </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#examples class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> </li> <li class=md-nav__item> <a href=#see-also class=md-nav__link> <span class=md-ellipsis> See Also </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../routing/ class=md-nav__link> <span class=md-ellipsis> Routing </span> </a> </li> <li class=md-nav__item> <a href=../parallel/ class=md-nav__link> <span class=md-ellipsis> Parallel </span> </a> </li> <li class=md-nav__item> <a href=../evaluator-optimizer/ class=md-nav__link> <span class=md-ellipsis> Evaluator-Optimizer </span> </a> </li> <li class=md-nav__item> <a href=../graph/ class=md-nav__link> <span class=md-ellipsis> Graph </span> </a> </li> <li class=md-nav__item> <a href=../orchestrator-workers/ class=md-nav__link> <span class=md-ellipsis> Orchestrator-Workers </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> How-To </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> How-To </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../validate-workflows/ class=md-nav__link> <span class=md-ellipsis> Validate Workflows </span> </a> </li> <li class=md-nav__item> <a href=../../run-workflows/ class=md-nav__link> <span class=md-ellipsis> Run Workflows </span> </a> </li> <li class=md-nav__item> <a href=../../session-management/ class=md-nav__link> <span class=md-ellipsis> Session Management </span> </a> </li> <li class=md-nav__item> <a href=../../hitl/ class=md-nav__link> <span class=md-ellipsis> Human-in-the-Loop (HITL) </span> </a> </li> <li class=md-nav__item> <a href=../../context-management/ class=md-nav__link> <span class=md-ellipsis> Context Management </span> </a> </li> <li class=md-nav__item> <a href=../../skills/ class=md-nav__link> <span class=md-ellipsis> Skills </span> </a> </li> <li class=md-nav__item> <a href=../../telemetry/ class=md-nav__link> <span class=md-ellipsis> Telemetry </span> </a> </li> <li class=md-nav__item> <a href=../../tools/ class=md-nav__link> <span class=md-ellipsis> Tools </span> </a> </li> <li class=md-nav__item> <a href=../../develop-tools/ class=md-nav__link> <span class=md-ellipsis> Develop Tools </span> </a> </li> <li class=md-nav__item> <a href=../../secrets/ class=md-nav__link> <span class=md-ellipsis> Secrets </span> </a> </li> <li class=md-nav__item> <a href=../../budgets/ class=md-nav__link> <span class=md-ellipsis> Budgets </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Explanation </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Explanation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../explanation/architecture/ class=md-nav__link> <span class=md-ellipsis> Architecture </span> </a> </li> <li class=md-nav__item> <a href=../../../explanation/design-decisions/ class=md-nav__link> <span class=md-ellipsis> Design Decisions </span> </a> </li> <li class=md-nav__item> <a href=../../../explanation/performance/ class=md-nav__link> <span class=md-ellipsis> Performance </span> </a> </li> <li class=md-nav__item> <a href=../../../explanation/security-model/ class=md-nav__link> <span class=md-ellipsis> Security Model </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0> <span class=md-ellipsis> Reference </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../reference/cli/ class=md-nav__link> <span class=md-ellipsis> CLI </span> </a> </li> <li class=md-nav__item> <a href=../../../reference/spec/ class=md-nav__link> <span class=md-ellipsis> Spec Quick Reference </span> </a> </li> <li class=md-nav__item> <a href=../../../reference/workflow-manual/ class=md-nav__link> <span class=md-ellipsis> Workflow Manual </span> </a> </li> <li class=md-nav__item> <a href=../../../reference/session-api/ class=md-nav__link> <span class=md-ellipsis> Session API </span> </a> </li> <li class=md-nav__item> <a href=../../../reference/schema/ class=md-nav__link> <span class=md-ellipsis> Schema </span> </a> </li> <li class=md-nav__item> <a href=../../../reference/exit-codes/ class=md-nav__link> <span class=md-ellipsis> Exit Codes </span> </a> </li> <li class=md-nav__item> <a href=../../../reference/environment/ class=md-nav__link> <span class=md-ellipsis> Environment </span> </a> </li> <li class=md-nav__item> <a href=../../../reference/troubleshooting/ class=md-nav__link> <span class=md-ellipsis> Troubleshooting </span> </a> </li> <li class=md-nav__item> <a href=../../../reference/security/ class=md-nav__link> <span class=md-ellipsis> Security </span> </a> </li> <li class=md-nav__item> <a href=../../../reference/integrations/ class=md-nav__link> <span class=md-ellipsis> Integrations </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_7_11> <label class=md-nav__link for=__nav_7_11 id=__nav_7_11_label tabindex=0> <span class=md-ellipsis> API </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_7_11_label aria-expanded=false> <label class=md-nav__title for=__nav_7_11> <span class="md-nav__icon md-icon"></span> API </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../reference/api/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../../reference/api/python-api/ class=md-nav__link> <span class=md-ellipsis> Python API </span> </a> </li> <li class=md-nav__item> <a href=../../../reference/api/builders/ class=md-nav__link> <span class=md-ellipsis> Builder API </span> </a> </li> <li class=md-nav__item> <a href=../../../reference/api/runtime/ class=md-nav__link> <span class=md-ellipsis> Runtime </span> </a> </li> <li class=md-nav__item> <a href=../../../reference/api/exec/ class=md-nav__link> <span class=md-ellipsis> Execution </span> </a> </li> <li class=md-nav__item> <a href=../../../reference/api/loader/ class=md-nav__link> <span class=md-ellipsis> Loader </span> </a> </li> <li class=md-nav__item> <a href=../../../reference/api/schema/ class=md-nav__link> <span class=md-ellipsis> Schema </span> </a> </li> <li class=md-nav__item> <a href=../../../reference/api/telemetry/ class=md-nav__link> <span class=md-ellipsis> Telemetry </span> </a> </li> <li class=md-nav__item> <a href=../../../reference/api/tools/ class=md-nav__link> <span class=md-ellipsis> Tools </span> </a> </li> <li class=md-nav__item> <a href=../../../reference/api/artifacts/ class=md-nav__link> <span class=md-ellipsis> Artifacts </span> </a> </li> <li class=md-nav__item> <a href=../../../reference/api/visualization/ class=md-nav__link> <span class=md-ellipsis> Visualization </span> </a> </li> <li class=md-nav__item> <a href=../../../reference/api/capability/ class=md-nav__link> <span class=md-ellipsis> Capability </span> </a> </li> <li class=md-nav__item> <a href=../../../reference/api/types/ class=md-nav__link> <span class=md-ellipsis> Types </span> </a> </li> <li class=md-nav__item> <a href=../../../reference/api/config/ class=md-nav__link> <span class=md-ellipsis> Config </span> </a> </li> <li class=md-nav__item> <a href=../../../reference/api/exit-codes/ class=md-nav__link> <span class=md-ellipsis> Exit Codes </span> </a> </li> <li class=md-nav__item> <a href=../../../reference/api/utils/ class=md-nav__link> <span class=md-ellipsis> Utils </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#when-to-use class=md-nav__link> <span class=md-ellipsis> When to Use </span> </a> </li> <li class=md-nav__item> <a href=#basic-example class=md-nav__link> <span class=md-ellipsis> Basic Example </span> </a> </li> <li class=md-nav__item> <a href=#task-dependencies class=md-nav__link> <span class=md-ellipsis> Task Dependencies </span> </a> <nav class=md-nav aria-label="Task Dependencies"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#no-dependencies-root-tasks class=md-nav__link> <span class=md-ellipsis> No Dependencies (Root Tasks) </span> </a> </li> <li class=md-nav__item> <a href=#single-dependency class=md-nav__link> <span class=md-ellipsis> Single Dependency </span> </a> </li> <li class=md-nav__item> <a href=#multiple-dependencies class=md-nav__link> <span class=md-ellipsis> Multiple Dependencies </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#accessing-task-results class=md-nav__link> <span class=md-ellipsis> Accessing Task Results </span> </a> <nav class=md-nav aria-label="Accessing Task Results"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#specific-task-outputs class=md-nav__link> <span class=md-ellipsis> Specific Task Outputs </span> </a> </li> <li class=md-nav__item> <a href=#task-metadata class=md-nav__link> <span class=md-ellipsis> Task Metadata </span> </a> </li> <li class=md-nav__item> <a href=#iterating-over-tasks class=md-nav__link> <span class=md-ellipsis> Iterating Over Tasks </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#parallel-execution class=md-nav__link> <span class=md-ellipsis> Parallel Execution </span> </a> <nav class=md-nav aria-label="Parallel Execution"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#controlling-concurrency class=md-nav__link> <span class=md-ellipsis> Controlling Concurrency </span> </a> </li> <li class=md-nav__item> <a href=#example-fan-outfan-in class=md-nav__link> <span class=md-ellipsis> Example: Fan-Out/Fan-In </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#dag-execution-order class=md-nav__link> <span class=md-ellipsis> DAG Execution Order </span> </a> <nav class=md-nav aria-label="DAG Execution Order"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#example-execution-timeline class=md-nav__link> <span class=md-ellipsis> Example Execution Timeline </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#advanced-features class=md-nav__link> <span class=md-ellipsis> Advanced Features </span> </a> <nav class=md-nav aria-label="Advanced Features"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#task-descriptions class=md-nav__link> <span class=md-ellipsis> Task Descriptions </span> </a> </li> <li class=md-nav__item> <a href=#conditional-task-content class=md-nav__link> <span class=md-ellipsis> Conditional Task Content </span> </a> </li> <li class=md-nav__item> <a href=#different-agents-per-task class=md-nav__link> <span class=md-ellipsis> Different Agents Per Task </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#error-handling class=md-nav__link> <span class=md-ellipsis> Error Handling </span> </a> <nav class=md-nav aria-label="Error Handling"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#task-failure-behavior class=md-nav__link> <span class=md-ellipsis> Task Failure Behavior </span> </a> </li> <li class=md-nav__item> <a href=#retry-configuration class=md-nav__link> <span class=md-ellipsis> Retry Configuration </span> </a> </li> <li class=md-nav__item> <a href=#budget-limits class=md-nav__link> <span class=md-ellipsis> Budget Limits </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#output-artifacts class=md-nav__link> <span class=md-ellipsis> Output Artifacts </span> </a> <nav class=md-nav aria-label="Output Artifacts"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#accessing-task-results_1 class=md-nav__link> <span class=md-ellipsis> Accessing Task Results </span> </a> </li> <li class=md-nav__item> <a href=#using-last-response class=md-nav__link> <span class=md-ellipsis> Using Last Response </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#best-practices class=md-nav__link> <span class=md-ellipsis> Best Practices </span> </a> <nav class=md-nav aria-label="Best Practices"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-design-for-parallelism class=md-nav__link> <span class=md-ellipsis> 1. Design for Parallelism </span> </a> </li> <li class=md-nav__item> <a href=#2-set-appropriate-max_parallel class=md-nav__link> <span class=md-ellipsis> 2. Set Appropriate max_parallel </span> </a> </li> <li class=md-nav__item> <a href=#3-use-descriptive-task-ids class=md-nav__link> <span class=md-ellipsis> 3. Use Descriptive Task IDs </span> </a> </li> <li class=md-nav__item> <a href=#4-validate-dag-structure class=md-nav__link> <span class=md-ellipsis> 4. Validate DAG Structure </span> </a> </li> <li class=md-nav__item> <a href=#5-manage-context-size class=md-nav__link> <span class=md-ellipsis> 5. Manage Context Size </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#common-patterns class=md-nav__link> <span class=md-ellipsis> Common Patterns </span> </a> <nav class=md-nav aria-label="Common Patterns"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#linear-pipeline-sequential class=md-nav__link> <span class=md-ellipsis> Linear Pipeline (Sequential) </span> </a> </li> <li class=md-nav__item> <a href=#diamond-pattern class=md-nav__link> <span class=md-ellipsis> Diamond Pattern </span> </a> </li> <li class=md-nav__item> <a href=#multi-stage-pipeline class=md-nav__link> <span class=md-ellipsis> Multi-Stage Pipeline </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#performance-considerations class=md-nav__link> <span class=md-ellipsis> Performance Considerations </span> </a> <nav class=md-nav aria-label="Performance Considerations"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#task-scheduling-overhead class=md-nav__link> <span class=md-ellipsis> Task Scheduling Overhead </span> </a> </li> <li class=md-nav__item> <a href=#agent-caching class=md-nav__link> <span class=md-ellipsis> Agent Caching </span> </a> </li> <li class=md-nav__item> <a href=#optimal-parallelism class=md-nav__link> <span class=md-ellipsis> Optimal Parallelism </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#troubleshooting class=md-nav__link> <span class=md-ellipsis> Troubleshooting </span> </a> <nav class=md-nav aria-label=Troubleshooting> <ul class=md-nav__list> <li class=md-nav__item> <a href=#workflow-not-completing class=md-nav__link> <span class=md-ellipsis> Workflow Not Completing </span> </a> </li> <li class=md-nav__item> <a href=#tasks-not-running-in-parallel class=md-nav__link> <span class=md-ellipsis> Tasks Not Running in Parallel </span> </a> </li> <li class=md-nav__item> <a href=#budget-exceeded class=md-nav__link> <span class=md-ellipsis> Budget Exceeded </span> </a> </li> <li class=md-nav__item> <a href=#task-failures class=md-nav__link> <span class=md-ellipsis> Task Failures </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#workflow-vs-other-patterns class=md-nav__link> <span class=md-ellipsis> Workflow vs. Other Patterns </span> </a> <nav class=md-nav aria-label="Workflow vs. Other Patterns"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#workflow-vs-chain class=md-nav__link> <span class=md-ellipsis> Workflow vs. Chain </span> </a> </li> <li class=md-nav__item> <a href=#workflow-vs-parallel class=md-nav__link> <span class=md-ellipsis> Workflow vs. Parallel </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#examples class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> </li> <li class=md-nav__item> <a href=#see-also class=md-nav__link> <span class=md-ellipsis> See Also </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=workflow-pattern>Workflow Pattern<a class=headerlink href=#workflow-pattern title="Permanent link">&para;</a></h1> <p>The Workflow pattern executes tasks as a Directed Acyclic Graph (DAG), enabling parallel execution of independent tasks while respecting dependencies. This is ideal for complex workflows where multiple tasks can run concurrently but some tasks depend on others completing first.</p> <h2 id=when-to-use>When to Use<a class=headerlink href=#when-to-use title="Permanent link">&para;</a></h2> <p>Use the Workflow pattern when you need to:</p> <ul> <li>Execute independent tasks concurrently for faster completion</li> <li>Define explicit task dependencies (task B waits for task A)</li> <li>Build complex multi-stage pipelines with parallel branches</li> <li>Optimize execution time by parallelizing independent work</li> <li>Maintain clear task relationships in complex workflows</li> </ul> <h2 id=basic-example>Basic Example<a class=headerlink href=#basic-example title="Permanent link">&para;</a></h2> <div class="tabbed-set tabbed-alternate" data-tabs=1:2><input checked=checked id=__tabbed_1_1 name=__tabbed_1 type=radio><input id=__tabbed_1_2 name=__tabbed_1 type=radio><div class=tabbed-labels><label for=__tabbed_1_1>YAML</label><label for=__tabbed_1_2>Builder API</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">simple-workflow</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">DAG-based research workflow</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=nt>runtime</span><span class=p>:</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=w>  </span><span class=nt>provider</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">bedrock</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=w>  </span><span class=nt>model</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">anthropic.claude-3-sonnet-20240229-v1:0</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=w>  </span><span class=nt>max_parallel</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">2</span><span class=w>  </span><span class=c1># Run up to 2 tasks concurrently</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=nt>agents</span><span class=p>:</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">researcher</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a><span class=w>    </span><span class=nt>system</span><span class=p>:</span><span class=w> </span><span class=s>&quot;You</span><span class=nv> </span><span class=s>are</span><span class=nv> </span><span class=s>a</span><span class=nv> </span><span class=s>research</span><span class=nv> </span><span class=s>assistant</span><span class=nv> </span><span class=s>providing</span><span class=nv> </span><span class=s>factual</span><span class=nv> </span><span class=s>information.&quot;</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a><span class=nt>pattern</span><span class=p>:</span>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">workflow</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a><span class=w>  </span><span class=nt>config</span><span class=p>:</span>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a><span class=w>    </span><span class=nt>tasks</span><span class=p>:</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18 href=#__codelineno-0-18></a><span class=w>      </span><span class=c1># Root task - no dependencies</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19 href=#__codelineno-0-19></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">overview</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20 href=#__codelineno-0-20></a><span class=w>        </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">researcher</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21 href=#__codelineno-0-21></a><span class=w>        </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Get</span><span class=nv> </span><span class=s>high-level</span><span class=nv> </span><span class=s>overview&quot;</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22 href=#__codelineno-0-22></a><span class=w>        </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Provide</span><span class=nv> </span><span class=s>a</span><span class=nv> </span><span class=s>brief</span><span class=nv> </span><span class=s>overview</span><span class=nv> </span><span class=s>of</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>topic</span><span class=nv> </span><span class=s>}}&quot;</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23 href=#__codelineno-0-23></a>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24 href=#__codelineno-0-24></a><span class=w>      </span><span class=c1># Parallel tasks - both depend on overview</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25 href=#__codelineno-0-25></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">technical</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26 href=#__codelineno-0-26></a><span class=w>        </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">researcher</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27 href=#__codelineno-0-27></a><span class=w>        </span><span class=nt>deps</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>overview</span><span class="p p-Indicator">]</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28 href=#__codelineno-0-28></a><span class=w>        </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Research</span><span class=nv> </span><span class=s>technical</span><span class=nv> </span><span class=s>aspects&quot;</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29 href=#__codelineno-0-29></a><span class=w>        </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">|</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30 href=#__codelineno-0-30></a><span class=w>          </span><span class=no>Overview: {{ tasks.overview.response }}</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31 href=#__codelineno-0-31></a>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32 href=#__codelineno-0-32></a><span class=w>          </span><span class=no>Research the technical details of {{ topic }}</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33 href=#__codelineno-0-33></a>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34 href=#__codelineno-0-34></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">business</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35 href=#__codelineno-0-35></a><span class=w>        </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">researcher</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36 href=#__codelineno-0-36></a><span class=w>        </span><span class=nt>deps</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>overview</span><span class="p p-Indicator">]</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37 href=#__codelineno-0-37></a><span class=w>        </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Research</span><span class=nv> </span><span class=s>business</span><span class=nv> </span><span class=s>aspects&quot;</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38 href=#__codelineno-0-38></a><span class=w>        </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">|</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39 href=#__codelineno-0-39></a><span class=w>          </span><span class=no>Overview: {{ tasks.overview.response }}</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40 href=#__codelineno-0-40></a>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41 href=#__codelineno-0-41></a><span class=w>          </span><span class=no>Research the business implications of {{ topic }}</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42 href=#__codelineno-0-42></a>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43 href=#__codelineno-0-43></a><span class=w>      </span><span class=c1># Final task - depends on both parallel tasks</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44 href=#__codelineno-0-44></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">synthesis</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45 href=#__codelineno-0-45></a><span class=w>        </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">researcher</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46 href=#__codelineno-0-46></a><span class=w>        </span><span class=nt>deps</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>technical</span><span class="p p-Indicator">,</span><span class=w> </span><span class=nv>business</span><span class="p p-Indicator">]</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47 href=#__codelineno-0-47></a><span class=w>        </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Synthesize</span><span class=nv> </span><span class=s>findings&quot;</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48 href=#__codelineno-0-48></a><span class=w>        </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">|</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49 href=#__codelineno-0-49></a><span class=w>          </span><span class=no>Technical: {{ tasks.technical.response }}</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50 href=#__codelineno-0-50></a><span class=w>          </span><span class=no>Business: {{ tasks.business.response }}</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51 href=#__codelineno-0-51></a>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52 href=#__codelineno-0-52></a><span class=w>          </span><span class=no>Write a comprehensive report.</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53 href=#__codelineno-0-53></a>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54 href=#__codelineno-0-54></a><span class=nt>inputs</span><span class=p>:</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55 href=#__codelineno-0-55></a><span class=w>  </span><span class=nt>topic</span><span class=p>:</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56 href=#__codelineno-0-56></a><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57 href=#__codelineno-0-57></a><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Research</span><span class=nv> </span><span class=s>topic&quot;</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58 href=#__codelineno-0-58></a><span class=w>    </span><span class=nt>default</span><span class=p>:</span><span class=w> </span><span class=s>&quot;artificial</span><span class=nv> </span><span class=s>intelligence&quot;</span>
</span></code></pre></div> </div> <div class=tabbed-block> <div class="language-python highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=kn>from</span><span class=w> </span><span class=nn>strands_cli.api</span><span class=w> </span><span class=kn>import</span> <span class=n>FluentBuilder</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=n>workflow</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a>    <span class=n>FluentBuilder</span><span class=p>(</span><span class=s2>&quot;simple-workflow&quot;</span><span class=p>)</span>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a>    <span class=o>.</span><span class=n>description</span><span class=p>(</span><span class=s2>&quot;DAG-based research workflow&quot;</span><span class=p>)</span>
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a>    <span class=o>.</span><span class=n>runtime</span><span class=p>(</span><span class=s2>&quot;bedrock&quot;</span><span class=p>,</span>
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a>             <span class=n>model</span><span class=o>=</span><span class=s2>&quot;anthropic.claude-3-sonnet-20240229-v1:0&quot;</span><span class=p>,</span>
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a>             <span class=n>max_parallel</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
</span><span id=__span-1-9><a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a>    <span class=o>.</span><span class=n>agent</span><span class=p>(</span><span class=s2>&quot;researcher&quot;</span><span class=p>,</span>
</span><span id=__span-1-10><a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a>           <span class=s2>&quot;You are a research assistant providing factual information.&quot;</span><span class=p>)</span>
</span><span id=__span-1-11><a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a>    <span class=o>.</span><span class=n>workflow</span><span class=p>()</span>
</span><span id=__span-1-12><a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a>    <span class=c1># Root task - no dependencies</span>
</span><span id=__span-1-13><a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a>    <span class=o>.</span><span class=n>task</span><span class=p>(</span><span class=s2>&quot;overview&quot;</span><span class=p>,</span> <span class=s2>&quot;researcher&quot;</span><span class=p>,</span>
</span><span id=__span-1-14><a id=__codelineno-1-14 name=__codelineno-1-14 href=#__codelineno-1-14></a>          <span class=s2>&quot;Provide a brief overview of {{ topic }}&quot;</span><span class=p>)</span>
</span><span id=__span-1-15><a id=__codelineno-1-15 name=__codelineno-1-15 href=#__codelineno-1-15></a>    <span class=c1># Parallel tasks - both depend on overview</span>
</span><span id=__span-1-16><a id=__codelineno-1-16 name=__codelineno-1-16 href=#__codelineno-1-16></a>    <span class=o>.</span><span class=n>task</span><span class=p>(</span><span class=s2>&quot;technical&quot;</span><span class=p>,</span> <span class=s2>&quot;researcher&quot;</span><span class=p>,</span>
</span><span id=__span-1-17><a id=__codelineno-1-17 name=__codelineno-1-17 href=#__codelineno-1-17></a><span class=w>          </span><span class=sd>&quot;&quot;&quot;Overview: {{ tasks.overview.response }}</span>
</span><span id=__span-1-18><a id=__codelineno-1-18 name=__codelineno-1-18 href=#__codelineno-1-18></a>
</span><span id=__span-1-19><a id=__codelineno-1-19 name=__codelineno-1-19 href=#__codelineno-1-19></a><span class=sd>          Research the technical details of {{ topic }}&quot;&quot;&quot;</span><span class=p>,</span>
</span><span id=__span-1-20><a id=__codelineno-1-20 name=__codelineno-1-20 href=#__codelineno-1-20></a>          <span class=n>depends_on</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;overview&quot;</span><span class=p>])</span>
</span><span id=__span-1-21><a id=__codelineno-1-21 name=__codelineno-1-21 href=#__codelineno-1-21></a>    <span class=o>.</span><span class=n>task</span><span class=p>(</span><span class=s2>&quot;business&quot;</span><span class=p>,</span> <span class=s2>&quot;researcher&quot;</span><span class=p>,</span>
</span><span id=__span-1-22><a id=__codelineno-1-22 name=__codelineno-1-22 href=#__codelineno-1-22></a><span class=w>          </span><span class=sd>&quot;&quot;&quot;Overview: {{ tasks.overview.response }}</span>
</span><span id=__span-1-23><a id=__codelineno-1-23 name=__codelineno-1-23 href=#__codelineno-1-23></a>
</span><span id=__span-1-24><a id=__codelineno-1-24 name=__codelineno-1-24 href=#__codelineno-1-24></a><span class=sd>          Research the business implications of {{ topic }}&quot;&quot;&quot;</span><span class=p>,</span>
</span><span id=__span-1-25><a id=__codelineno-1-25 name=__codelineno-1-25 href=#__codelineno-1-25></a>          <span class=n>depends_on</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;overview&quot;</span><span class=p>])</span>
</span><span id=__span-1-26><a id=__codelineno-1-26 name=__codelineno-1-26 href=#__codelineno-1-26></a>    <span class=c1># Final task - depends on both parallel tasks</span>
</span><span id=__span-1-27><a id=__codelineno-1-27 name=__codelineno-1-27 href=#__codelineno-1-27></a>    <span class=o>.</span><span class=n>task</span><span class=p>(</span><span class=s2>&quot;synthesis&quot;</span><span class=p>,</span> <span class=s2>&quot;researcher&quot;</span><span class=p>,</span>
</span><span id=__span-1-28><a id=__codelineno-1-28 name=__codelineno-1-28 href=#__codelineno-1-28></a><span class=w>          </span><span class=sd>&quot;&quot;&quot;Technical: {{ tasks.technical.response }}</span>
</span><span id=__span-1-29><a id=__codelineno-1-29 name=__codelineno-1-29 href=#__codelineno-1-29></a><span class=sd>          Business: {{ tasks.business.response }}</span>
</span><span id=__span-1-30><a id=__codelineno-1-30 name=__codelineno-1-30 href=#__codelineno-1-30></a>
</span><span id=__span-1-31><a id=__codelineno-1-31 name=__codelineno-1-31 href=#__codelineno-1-31></a><span class=sd>          Write a comprehensive report.&quot;&quot;&quot;</span><span class=p>,</span>
</span><span id=__span-1-32><a id=__codelineno-1-32 name=__codelineno-1-32 href=#__codelineno-1-32></a>          <span class=n>depends_on</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;technical&quot;</span><span class=p>,</span> <span class=s2>&quot;business&quot;</span><span class=p>])</span>
</span><span id=__span-1-33><a id=__codelineno-1-33 name=__codelineno-1-33 href=#__codelineno-1-33></a>    <span class=o>.</span><span class=n>build</span><span class=p>()</span>
</span><span id=__span-1-34><a id=__codelineno-1-34 name=__codelineno-1-34 href=#__codelineno-1-34></a><span class=p>)</span>
</span><span id=__span-1-35><a id=__codelineno-1-35 name=__codelineno-1-35 href=#__codelineno-1-35></a>
</span><span id=__span-1-36><a id=__codelineno-1-36 name=__codelineno-1-36 href=#__codelineno-1-36></a><span class=c1># Execute with topic variable</span>
</span><span id=__span-1-37><a id=__codelineno-1-37 name=__codelineno-1-37 href=#__codelineno-1-37></a><span class=n>result</span> <span class=o>=</span> <span class=n>workflow</span><span class=o>.</span><span class=n>run_interactive</span><span class=p>(</span><span class=n>topic</span><span class=o>=</span><span class=s2>&quot;artificial intelligence&quot;</span><span class=p>)</span>
</span><span id=__span-1-38><a id=__codelineno-1-38 name=__codelineno-1-38 href=#__codelineno-1-38></a><span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>last_response</span><span class=p>)</span>
</span></code></pre></div> </div> </div> </div> <h2 id=task-dependencies>Task Dependencies<a class=headerlink href=#task-dependencies title="Permanent link">&para;</a></h2> <h3 id=no-dependencies-root-tasks>No Dependencies (Root Tasks)<a class=headerlink href=#no-dependencies-root-tasks title="Permanent link">&para;</a></h3> <p>Tasks with no <code>deps</code> field execute immediately:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=nt>tasks</span><span class=p>:</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">task1</span>
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">researcher</span>
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=w>    </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Independent</span><span class=nv> </span><span class=s>task</span><span class=nv> </span><span class=s>1&quot;</span>
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a>
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">task2</span>
</span><span id=__span-2-7><a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">researcher</span>
</span><span id=__span-2-8><a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a><span class=w>    </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Independent</span><span class=nv> </span><span class=s>task</span><span class=nv> </span><span class=s>2&quot;</span><span class=w>  </span><span class=c1># Runs concurrently with task1</span>
</span></code></pre></div> <h3 id=single-dependency>Single Dependency<a class=headerlink href=#single-dependency title="Permanent link">&para;</a></h3> <p>Task waits for one parent to complete:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=nt>tasks</span><span class=p>:</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">research</span>
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">researcher</span>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=w>    </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Gather</span><span class=nv> </span><span class=s>information&quot;</span>
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a>
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">analyze</span>
</span><span id=__span-3-7><a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">analyst</span>
</span><span id=__span-3-8><a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a><span class=w>    </span><span class=nt>deps</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>research</span><span class="p p-Indicator">]</span><span class=w>  </span><span class=c1># Waits for research to complete</span>
</span><span id=__span-3-9><a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a><span class=w>    </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Analyze:</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>tasks.research.response</span><span class=nv> </span><span class=s>}}&quot;</span>
</span></code></pre></div> <h3 id=multiple-dependencies>Multiple Dependencies<a class=headerlink href=#multiple-dependencies title="Permanent link">&para;</a></h3> <p>Task waits for all parents to complete:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=nt>tasks</span><span class=p>:</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">source1</span>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">researcher</span>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=w>    </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Research</span><span class=nv> </span><span class=s>source</span><span class=nv> </span><span class=s>1&quot;</span>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">source2</span>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">researcher</span>
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a><span class=w>    </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Research</span><span class=nv> </span><span class=s>source</span><span class=nv> </span><span class=s>2&quot;</span>
</span><span id=__span-4-9><a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a>
</span><span id=__span-4-10><a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">synthesis</span>
</span><span id=__span-4-11><a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">analyst</span>
</span><span id=__span-4-12><a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a><span class=w>    </span><span class=nt>deps</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>source1</span><span class="p p-Indicator">,</span><span class=w> </span><span class=nv>source2</span><span class="p p-Indicator">]</span><span class=w>  </span><span class=c1># Waits for BOTH to complete</span>
</span><span id=__span-4-13><a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a><span class=w>    </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">|</span>
</span><span id=__span-4-14><a id=__codelineno-4-14 name=__codelineno-4-14 href=#__codelineno-4-14></a><span class=w>      </span><span class=no>Source 1: {{ tasks.source1.response }}</span>
</span><span id=__span-4-15><a id=__codelineno-4-15 name=__codelineno-4-15 href=#__codelineno-4-15></a><span class=w>      </span><span class=no>Source 2: {{ tasks.source2.response }}</span>
</span><span id=__span-4-16><a id=__codelineno-4-16 name=__codelineno-4-16 href=#__codelineno-4-16></a>
</span><span id=__span-4-17><a id=__codelineno-4-17 name=__codelineno-4-17 href=#__codelineno-4-17></a><span class=w>      </span><span class=no>Synthesize both sources.</span>
</span></code></pre></div> <h2 id=accessing-task-results>Accessing Task Results<a class=headerlink href=#accessing-task-results title="Permanent link">&para;</a></h2> <h3 id=specific-task-outputs>Specific Task Outputs<a class=headerlink href=#specific-task-outputs title="Permanent link">&para;</a></h3> <p>Access any completed task by its ID:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=c1># Single task reference</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Build</span><span class=nv> </span><span class=s>on:</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>tasks.overview.response</span><span class=nv> </span><span class=s>}}&quot;</span>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a><span class=c1># Multiple task references</span>
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">|</span>
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a><span class=w>  </span><span class=no>Technical: {{ tasks.technical.response }}</span>
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a><span class=w>  </span><span class=no>Business: {{ tasks.business.response }}</span>
</span><span id=__span-5-8><a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a>
</span><span id=__span-5-9><a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a><span class=w>  </span><span class=no>Combine both perspectives.</span>
</span></code></pre></div> <h3 id=task-metadata>Task Metadata<a class=headerlink href=#task-metadata title="Permanent link">&para;</a></h3> <p>Access task status and metadata:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=nt>outputs</span><span class=p>:</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=w>  </span><span class=nt>artifacts</span><span class=p>:</span>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=s>&quot;report.md&quot;</span>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=w>      </span><span class=nt>content</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">|</span>
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a><span class=w>        </span><span class=no>## Technical Analysis</span>
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a><span class=w>        </span><span class=no>Status: {{ tasks.technical.status }}</span>
</span><span id=__span-6-7><a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a><span class=w>        </span><span class=no>{{ tasks.technical.response }}</span>
</span></code></pre></div> <h3 id=iterating-over-tasks>Iterating Over Tasks<a class=headerlink href=#iterating-over-tasks title="Permanent link">&para;</a></h3> <p>Loop through completed tasks:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">|</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=w>  </span><span class=no>Review all completed tasks:</span>
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=w>  </span><span class=no>{% for task_id, task in tasks.items() %}</span>
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a><span class=w>  </span><span class=no>{{ task_id }}: {{ task.response | truncate(100) }}</span>
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a><span class=w>  </span><span class=no>{% endfor %}</span>
</span></code></pre></div> <h2 id=parallel-execution>Parallel Execution<a class=headerlink href=#parallel-execution title="Permanent link">&para;</a></h2> <h3 id=controlling-concurrency>Controlling Concurrency<a class=headerlink href=#controlling-concurrency title="Permanent link">&para;</a></h3> <p>Limit concurrent task execution:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=nt>runtime</span><span class=p>:</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a><span class=w>  </span><span class=nt>provider</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">bedrock</span>
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=w>  </span><span class=nt>model</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">anthropic.claude-3-sonnet-20240229-v1:0</span>
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a><span class=w>  </span><span class=nt>max_parallel</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">3</span><span class=w>  </span><span class=c1># Maximum 3 tasks running simultaneously</span>
</span></code></pre></div> <p>Without <code>max_parallel</code>, all independent tasks run concurrently.</p> <h3 id=example-fan-outfan-in>Example: Fan-Out/Fan-In<a class=headerlink href=#example-fan-outfan-in title="Permanent link">&para;</a></h3> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=nt>tasks</span><span class=p>:</span>
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a><span class=w>  </span><span class=c1># Single source task</span>
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">source</span>
</span><span id=__span-9-4><a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">researcher</span>
</span><span id=__span-9-5><a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a><span class=w>    </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Research</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>topic</span><span class=nv> </span><span class=s>}}&quot;</span>
</span><span id=__span-9-6><a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a>
</span><span id=__span-9-7><a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a><span class=w>  </span><span class=c1># Fan-out: Multiple parallel tasks</span>
</span><span id=__span-9-8><a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">aspect1</span>
</span><span id=__span-9-9><a id=__codelineno-9-9 name=__codelineno-9-9 href=#__codelineno-9-9></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">analyst</span>
</span><span id=__span-9-10><a id=__codelineno-9-10 name=__codelineno-9-10 href=#__codelineno-9-10></a><span class=w>    </span><span class=nt>deps</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>source</span><span class="p p-Indicator">]</span>
</span><span id=__span-9-11><a id=__codelineno-9-11 name=__codelineno-9-11 href=#__codelineno-9-11></a><span class=w>    </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Analyze</span><span class=nv> </span><span class=s>aspect</span><span class=nv> </span><span class=s>1:</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>tasks.source.response</span><span class=nv> </span><span class=s>}}&quot;</span>
</span><span id=__span-9-12><a id=__codelineno-9-12 name=__codelineno-9-12 href=#__codelineno-9-12></a>
</span><span id=__span-9-13><a id=__codelineno-9-13 name=__codelineno-9-13 href=#__codelineno-9-13></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">aspect2</span>
</span><span id=__span-9-14><a id=__codelineno-9-14 name=__codelineno-9-14 href=#__codelineno-9-14></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">analyst</span>
</span><span id=__span-9-15><a id=__codelineno-9-15 name=__codelineno-9-15 href=#__codelineno-9-15></a><span class=w>    </span><span class=nt>deps</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>source</span><span class="p p-Indicator">]</span>
</span><span id=__span-9-16><a id=__codelineno-9-16 name=__codelineno-9-16 href=#__codelineno-9-16></a><span class=w>    </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Analyze</span><span class=nv> </span><span class=s>aspect</span><span class=nv> </span><span class=s>2:</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>tasks.source.response</span><span class=nv> </span><span class=s>}}&quot;</span>
</span><span id=__span-9-17><a id=__codelineno-9-17 name=__codelineno-9-17 href=#__codelineno-9-17></a>
</span><span id=__span-9-18><a id=__codelineno-9-18 name=__codelineno-9-18 href=#__codelineno-9-18></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">aspect3</span>
</span><span id=__span-9-19><a id=__codelineno-9-19 name=__codelineno-9-19 href=#__codelineno-9-19></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">analyst</span>
</span><span id=__span-9-20><a id=__codelineno-9-20 name=__codelineno-9-20 href=#__codelineno-9-20></a><span class=w>    </span><span class=nt>deps</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>source</span><span class="p p-Indicator">]</span>
</span><span id=__span-9-21><a id=__codelineno-9-21 name=__codelineno-9-21 href=#__codelineno-9-21></a><span class=w>    </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Analyze</span><span class=nv> </span><span class=s>aspect</span><span class=nv> </span><span class=s>3:</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>tasks.source.response</span><span class=nv> </span><span class=s>}}&quot;</span>
</span><span id=__span-9-22><a id=__codelineno-9-22 name=__codelineno-9-22 href=#__codelineno-9-22></a>
</span><span id=__span-9-23><a id=__codelineno-9-23 name=__codelineno-9-23 href=#__codelineno-9-23></a><span class=w>  </span><span class=c1># Fan-in: Single synthesis task</span>
</span><span id=__span-9-24><a id=__codelineno-9-24 name=__codelineno-9-24 href=#__codelineno-9-24></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">synthesis</span>
</span><span id=__span-9-25><a id=__codelineno-9-25 name=__codelineno-9-25 href=#__codelineno-9-25></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">writer</span>
</span><span id=__span-9-26><a id=__codelineno-9-26 name=__codelineno-9-26 href=#__codelineno-9-26></a><span class=w>    </span><span class=nt>deps</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>aspect1</span><span class="p p-Indicator">,</span><span class=w> </span><span class=nv>aspect2</span><span class="p p-Indicator">,</span><span class=w> </span><span class=nv>aspect3</span><span class="p p-Indicator">]</span>
</span><span id=__span-9-27><a id=__codelineno-9-27 name=__codelineno-9-27 href=#__codelineno-9-27></a><span class=w>    </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">|</span>
</span><span id=__span-9-28><a id=__codelineno-9-28 name=__codelineno-9-28 href=#__codelineno-9-28></a><span class=w>      </span><span class=no>Aspect 1: {{ tasks.aspect1.response }}</span>
</span><span id=__span-9-29><a id=__codelineno-9-29 name=__codelineno-9-29 href=#__codelineno-9-29></a><span class=w>      </span><span class=no>Aspect 2: {{ tasks.aspect2.response }}</span>
</span><span id=__span-9-30><a id=__codelineno-9-30 name=__codelineno-9-30 href=#__codelineno-9-30></a><span class=w>      </span><span class=no>Aspect 3: {{ tasks.aspect3.response }}</span>
</span><span id=__span-9-31><a id=__codelineno-9-31 name=__codelineno-9-31 href=#__codelineno-9-31></a>
</span><span id=__span-9-32><a id=__codelineno-9-32 name=__codelineno-9-32 href=#__codelineno-9-32></a><span class=w>      </span><span class=no>Synthesize all aspects.</span>
</span></code></pre></div> <h2 id=dag-execution-order>DAG Execution Order<a class=headerlink href=#dag-execution-order title="Permanent link">&para;</a></h2> <p>The workflow executor:</p> <ol> <li>Identifies root tasks (no dependencies)</li> <li>Executes root tasks (up to <code>max_parallel</code> concurrently)</li> <li>As tasks complete, checks which dependent tasks can now run</li> <li>Continues until all tasks complete</li> </ol> <h3 id=example-execution-timeline>Example Execution Timeline<a class=headerlink href=#example-execution-timeline title="Permanent link">&para;</a></h3> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=nt>tasks</span><span class=p>:</span>
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">A</span><span class=w>          </span><span class=c1># Starts at t=0</span>
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">B</span><span class=w>          </span><span class=c1># Starts at t=0 (parallel with A)</span>
</span><span id=__span-10-4><a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">C</span>
</span><span id=__span-10-5><a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a><span class=w>    </span><span class=nt>deps</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>A</span><span class="p p-Indicator">]</span><span class=w>      </span><span class=c1># Starts when A completes</span>
</span><span id=__span-10-6><a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">D</span>
</span><span id=__span-10-7><a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a><span class=w>    </span><span class=nt>deps</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>A</span><span class="p p-Indicator">,</span><span class=w> </span><span class=nv>B</span><span class="p p-Indicator">]</span><span class=w>   </span><span class=c1># Starts when BOTH A and B complete</span>
</span><span id=__span-10-8><a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">E</span>
</span><span id=__span-10-9><a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a><span class=w>    </span><span class=nt>deps</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>C</span><span class="p p-Indicator">,</span><span class=w> </span><span class=nv>D</span><span class="p p-Indicator">]</span><span class=w>   </span><span class=c1># Starts when BOTH C and D complete</span>
</span></code></pre></div> <p>Timeline: <div class="language-text highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a>t=0:  A and B start (parallel)
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a>t=5:  A completes  C starts
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a>t=7:  B completes  D starts (A already done)
</span><span id=__span-11-4><a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a>t=10: C completes
</span><span id=__span-11-5><a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a>t=12: D completes  E starts (C and D both done)
</span><span id=__span-11-6><a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a>t=15: E completes
</span></code></pre></div></p> <h2 id=advanced-features>Advanced Features<a class=headerlink href=#advanced-features title="Permanent link">&para;</a></h2> <h3 id=task-descriptions>Task Descriptions<a class=headerlink href=#task-descriptions title="Permanent link">&para;</a></h3> <p>Provide human-readable descriptions for logging:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=nt>tasks</span><span class=p>:</span>
</span><span id=__span-12-2><a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">research</span>
</span><span id=__span-12-3><a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">researcher</span>
</span><span id=__span-12-4><a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Gather</span><span class=nv> </span><span class=s>initial</span><span class=nv> </span><span class=s>data</span><span class=nv> </span><span class=s>about</span><span class=nv> </span><span class=s>the</span><span class=nv> </span><span class=s>topic&quot;</span><span class=w>  </span><span class=c1># Shown in logs</span>
</span><span id=__span-12-5><a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a><span class=w>    </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Research</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>topic</span><span class=nv> </span><span class=s>}}&quot;</span>
</span></code></pre></div> <h3 id=conditional-task-content>Conditional Task Content<a class=headerlink href=#conditional-task-content title="Permanent link">&para;</a></h3> <p>Use Jinja2 conditionals in task inputs:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-13-1><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=nt>tasks</span><span class=p>:</span>
</span><span id=__span-13-2><a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">synthesis</span>
</span><span id=__span-13-3><a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">writer</span>
</span><span id=__span-13-4><a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a><span class=w>    </span><span class=nt>deps</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>research</span><span class="p p-Indicator">,</span><span class=w> </span><span class=nv>analysis</span><span class="p p-Indicator">]</span>
</span><span id=__span-13-5><a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a><span class=w>    </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">|</span>
</span><span id=__span-13-6><a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a><span class=w>      </span><span class=no>{% if tasks.research.response | length &gt; 500 %}</span>
</span><span id=__span-13-7><a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a><span class=w>      </span><span class=no>Research (truncated): {{ tasks.research.response | truncate(200) }}</span>
</span><span id=__span-13-8><a id=__codelineno-13-8 name=__codelineno-13-8 href=#__codelineno-13-8></a><span class=w>      </span><span class=no>{% else %}</span>
</span><span id=__span-13-9><a id=__codelineno-13-9 name=__codelineno-13-9 href=#__codelineno-13-9></a><span class=w>      </span><span class=no>Research: {{ tasks.research.response }}</span>
</span><span id=__span-13-10><a id=__codelineno-13-10 name=__codelineno-13-10 href=#__codelineno-13-10></a><span class=w>      </span><span class=no>{% endif %}</span>
</span><span id=__span-13-11><a id=__codelineno-13-11 name=__codelineno-13-11 href=#__codelineno-13-11></a>
</span><span id=__span-13-12><a id=__codelineno-13-12 name=__codelineno-13-12 href=#__codelineno-13-12></a><span class=w>      </span><span class=no>Analysis: {{ tasks.analysis.response }}</span>
</span><span id=__span-13-13><a id=__codelineno-13-13 name=__codelineno-13-13 href=#__codelineno-13-13></a>
</span><span id=__span-13-14><a id=__codelineno-13-14 name=__codelineno-13-14 href=#__codelineno-13-14></a><span class=w>      </span><span class=no>Write a summary.</span>
</span></code></pre></div> <h3 id=different-agents-per-task>Different Agents Per Task<a class=headerlink href=#different-agents-per-task title="Permanent link">&para;</a></h3> <p>Assign specialized agents to different tasks:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-14-1><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=nt>agents</span><span class=p>:</span>
</span><span id=__span-14-2><a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">researcher</span>
</span><span id=__span-14-3><a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a><span class=w>    </span><span class=nt>system</span><span class=p>:</span><span class=w> </span><span class=s>&quot;You</span><span class=nv> </span><span class=s>research</span><span class=nv> </span><span class=s>topics</span><span class=nv> </span><span class=s>thoroughly.&quot;</span>
</span><span id=__span-14-4><a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a>
</span><span id=__span-14-5><a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">analyst</span>
</span><span id=__span-14-6><a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a><span class=w>    </span><span class=nt>system</span><span class=p>:</span><span class=w> </span><span class=s>&quot;You</span><span class=nv> </span><span class=s>analyze</span><span class=nv> </span><span class=s>data</span><span class=nv> </span><span class=s>critically.&quot;</span>
</span><span id=__span-14-7><a id=__codelineno-14-7 name=__codelineno-14-7 href=#__codelineno-14-7></a>
</span><span id=__span-14-8><a id=__codelineno-14-8 name=__codelineno-14-8 href=#__codelineno-14-8></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">writer</span>
</span><span id=__span-14-9><a id=__codelineno-14-9 name=__codelineno-14-9 href=#__codelineno-14-9></a><span class=w>    </span><span class=nt>system</span><span class=p>:</span><span class=w> </span><span class=s>&quot;You</span><span class=nv> </span><span class=s>write</span><span class=nv> </span><span class=s>clear</span><span class=nv> </span><span class=s>reports.&quot;</span>
</span><span id=__span-14-10><a id=__codelineno-14-10 name=__codelineno-14-10 href=#__codelineno-14-10></a>
</span><span id=__span-14-11><a id=__codelineno-14-11 name=__codelineno-14-11 href=#__codelineno-14-11></a><span class=nt>tasks</span><span class=p>:</span>
</span><span id=__span-14-12><a id=__codelineno-14-12 name=__codelineno-14-12 href=#__codelineno-14-12></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">gather</span>
</span><span id=__span-14-13><a id=__codelineno-14-13 name=__codelineno-14-13 href=#__codelineno-14-13></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">researcher</span>
</span><span id=__span-14-14><a id=__codelineno-14-14 name=__codelineno-14-14 href=#__codelineno-14-14></a><span class=w>    </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Research</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>topic</span><span class=nv> </span><span class=s>}}&quot;</span>
</span><span id=__span-14-15><a id=__codelineno-14-15 name=__codelineno-14-15 href=#__codelineno-14-15></a>
</span><span id=__span-14-16><a id=__codelineno-14-16 name=__codelineno-14-16 href=#__codelineno-14-16></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">analyze</span>
</span><span id=__span-14-17><a id=__codelineno-14-17 name=__codelineno-14-17 href=#__codelineno-14-17></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">analyst</span>
</span><span id=__span-14-18><a id=__codelineno-14-18 name=__codelineno-14-18 href=#__codelineno-14-18></a><span class=w>    </span><span class=nt>deps</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>gather</span><span class="p p-Indicator">]</span>
</span><span id=__span-14-19><a id=__codelineno-14-19 name=__codelineno-14-19 href=#__codelineno-14-19></a><span class=w>    </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Analyze:</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>tasks.gather.response</span><span class=nv> </span><span class=s>}}&quot;</span>
</span><span id=__span-14-20><a id=__codelineno-14-20 name=__codelineno-14-20 href=#__codelineno-14-20></a>
</span><span id=__span-14-21><a id=__codelineno-14-21 name=__codelineno-14-21 href=#__codelineno-14-21></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">report</span>
</span><span id=__span-14-22><a id=__codelineno-14-22 name=__codelineno-14-22 href=#__codelineno-14-22></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">writer</span>
</span><span id=__span-14-23><a id=__codelineno-14-23 name=__codelineno-14-23 href=#__codelineno-14-23></a><span class=w>    </span><span class=nt>deps</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>analyze</span><span class="p p-Indicator">]</span>
</span><span id=__span-14-24><a id=__codelineno-14-24 name=__codelineno-14-24 href=#__codelineno-14-24></a><span class=w>    </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Write</span><span class=nv> </span><span class=s>report:</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>tasks.analyze.response</span><span class=nv> </span><span class=s>}}&quot;</span>
</span></code></pre></div> <h2 id=error-handling>Error Handling<a class=headerlink href=#error-handling title="Permanent link">&para;</a></h2> <h3 id=task-failure-behavior>Task Failure Behavior<a class=headerlink href=#task-failure-behavior title="Permanent link">&para;</a></h3> <p>If a task fails: - Tasks depending on it will not execute - Independent tasks continue executing - Workflow fails with partial results</p> <h3 id=retry-configuration>Retry Configuration<a class=headerlink href=#retry-configuration title="Permanent link">&para;</a></h3> <p>Configure retries at the runtime level:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-15-1><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=nt>runtime</span><span class=p>:</span>
</span><span id=__span-15-2><a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a><span class=w>  </span><span class=nt>provider</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">bedrock</span>
</span><span id=__span-15-3><a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a><span class=w>  </span><span class=nt>model</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">anthropic.claude-3-sonnet-20240229-v1:0</span>
</span><span id=__span-15-4><a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a><span class=w>  </span><span class=nt>failure_policy</span><span class=p>:</span>
</span><span id=__span-15-5><a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a><span class=w>    </span><span class=nt>retries</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
</span><span id=__span-15-6><a id=__codelineno-15-6 name=__codelineno-15-6 href=#__codelineno-15-6></a><span class=w>    </span><span class=nt>backoff</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">exponential</span>
</span></code></pre></div> <p>Each task gets up to 3 retry attempts before failing.</p> <h3 id=budget-limits>Budget Limits<a class=headerlink href=#budget-limits title="Permanent link">&para;</a></h3> <p>Prevent runaway workflows:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-16-1><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=nt>runtime</span><span class=p>:</span>
</span><span id=__span-16-2><a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a><span class=w>  </span><span class=nt>budgets</span><span class=p>:</span>
</span><span id=__span-16-3><a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a><span class=w>    </span><span class=nt>max_tasks</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">20</span><span class=w>           </span><span class=c1># Maximum total tasks</span>
</span><span id=__span-16-4><a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a><span class=w>    </span><span class=nt>max_tokens</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">100000</span><span class=w>      </span><span class=c1># Maximum total tokens</span>
</span><span id=__span-16-5><a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a><span class=w>    </span><span class=nt>max_duration_s</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">600</span><span class=w>     </span><span class=c1># Maximum 10 minutes</span>
</span></code></pre></div> <h2 id=output-artifacts>Output Artifacts<a class=headerlink href=#output-artifacts title="Permanent link">&para;</a></h2> <h3 id=accessing-task-results_1>Accessing Task Results<a class=headerlink href=#accessing-task-results_1 title="Permanent link">&para;</a></h3> <p>Save workflow results to files:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-17-1><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=nt>outputs</span><span class=p>:</span>
</span><span id=__span-17-2><a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a><span class=w>  </span><span class=nt>artifacts</span><span class=p>:</span>
</span><span id=__span-17-3><a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=s>&quot;research_report.md&quot;</span>
</span><span id=__span-17-4><a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a><span class=w>      </span><span class=nt>content</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">|</span>
</span><span id=__span-17-5><a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a><span class=w>        </span><span class=no># {{ topic | title }} Report</span>
</span><span id=__span-17-6><a id=__codelineno-17-6 name=__codelineno-17-6 href=#__codelineno-17-6></a>
</span><span id=__span-17-7><a id=__codelineno-17-7 name=__codelineno-17-7 href=#__codelineno-17-7></a><span class=w>        </span><span class=no>## Overview</span>
</span><span id=__span-17-8><a id=__codelineno-17-8 name=__codelineno-17-8 href=#__codelineno-17-8></a><span class=w>        </span><span class=no>{{ tasks.overview.response }}</span>
</span><span id=__span-17-9><a id=__codelineno-17-9 name=__codelineno-17-9 href=#__codelineno-17-9></a>
</span><span id=__span-17-10><a id=__codelineno-17-10 name=__codelineno-17-10 href=#__codelineno-17-10></a><span class=w>        </span><span class=no>## Technical Analysis</span>
</span><span id=__span-17-11><a id=__codelineno-17-11 name=__codelineno-17-11 href=#__codelineno-17-11></a><span class=w>        </span><span class=no>{{ tasks.technical.response }}</span>
</span><span id=__span-17-12><a id=__codelineno-17-12 name=__codelineno-17-12 href=#__codelineno-17-12></a>
</span><span id=__span-17-13><a id=__codelineno-17-13 name=__codelineno-17-13 href=#__codelineno-17-13></a><span class=w>        </span><span class=no>## Business Analysis</span>
</span><span id=__span-17-14><a id=__codelineno-17-14 name=__codelineno-17-14 href=#__codelineno-17-14></a><span class=w>        </span><span class=no>{{ tasks.business.response }}</span>
</span><span id=__span-17-15><a id=__codelineno-17-15 name=__codelineno-17-15 href=#__codelineno-17-15></a>
</span><span id=__span-17-16><a id=__codelineno-17-16 name=__codelineno-17-16 href=#__codelineno-17-16></a><span class=w>        </span><span class=no>## Synthesis</span>
</span><span id=__span-17-17><a id=__codelineno-17-17 name=__codelineno-17-17 href=#__codelineno-17-17></a><span class=w>        </span><span class=no>{{ tasks.synthesis.response }}</span>
</span></code></pre></div> <h3 id=using-last-response>Using Last Response<a class=headerlink href=#using-last-response title="Permanent link">&para;</a></h3> <p>The <code>last_response</code> variable contains the final task's output:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-18-1><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=nt>outputs</span><span class=p>:</span>
</span><span id=__span-18-2><a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a><span class=w>  </span><span class=nt>artifacts</span><span class=p>:</span>
</span><span id=__span-18-3><a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=s>&quot;summary.txt&quot;</span>
</span><span id=__span-18-4><a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a><span class=w>      </span><span class=nt>content</span><span class=p>:</span><span class=w> </span><span class=s>&quot;{{</span><span class=nv> </span><span class=s>last_response</span><span class=nv> </span><span class=s>}}&quot;</span>
</span></code></pre></div> <h2 id=best-practices>Best Practices<a class=headerlink href=#best-practices title="Permanent link">&para;</a></h2> <h3 id=1-design-for-parallelism>1. Design for Parallelism<a class=headerlink href=#1-design-for-parallelism title="Permanent link">&para;</a></h3> <p>Identify independent tasks that can run concurrently:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-19-1><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=c1># Good - parallel research branches</span>
</span><span id=__span-19-2><a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a><span class=nt>tasks</span><span class=p>:</span>
</span><span id=__span-19-3><a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">source</span>
</span><span id=__span-19-4><a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">researcher</span>
</span><span id=__span-19-5><a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a><span class=w>    </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Overview</span><span class=nv> </span><span class=s>of</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>topic</span><span class=nv> </span><span class=s>}}&quot;</span>
</span><span id=__span-19-6><a id=__codelineno-19-6 name=__codelineno-19-6 href=#__codelineno-19-6></a>
</span><span id=__span-19-7><a id=__codelineno-19-7 name=__codelineno-19-7 href=#__codelineno-19-7></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">tech</span>
</span><span id=__span-19-8><a id=__codelineno-19-8 name=__codelineno-19-8 href=#__codelineno-19-8></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">researcher</span>
</span><span id=__span-19-9><a id=__codelineno-19-9 name=__codelineno-19-9 href=#__codelineno-19-9></a><span class=w>    </span><span class=nt>deps</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>source</span><span class="p p-Indicator">]</span>
</span><span id=__span-19-10><a id=__codelineno-19-10 name=__codelineno-19-10 href=#__codelineno-19-10></a><span class=w>    </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Technical</span><span class=nv> </span><span class=s>aspects&quot;</span>
</span><span id=__span-19-11><a id=__codelineno-19-11 name=__codelineno-19-11 href=#__codelineno-19-11></a>
</span><span id=__span-19-12><a id=__codelineno-19-12 name=__codelineno-19-12 href=#__codelineno-19-12></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">business</span>
</span><span id=__span-19-13><a id=__codelineno-19-13 name=__codelineno-19-13 href=#__codelineno-19-13></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">researcher</span>
</span><span id=__span-19-14><a id=__codelineno-19-14 name=__codelineno-19-14 href=#__codelineno-19-14></a><span class=w>    </span><span class=nt>deps</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>source</span><span class="p p-Indicator">]</span>
</span><span id=__span-19-15><a id=__codelineno-19-15 name=__codelineno-19-15 href=#__codelineno-19-15></a><span class=w>    </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Business</span><span class=nv> </span><span class=s>aspects&quot;</span><span class=w>  </span><span class=c1># Parallel with tech</span>
</span><span id=__span-19-16><a id=__codelineno-19-16 name=__codelineno-19-16 href=#__codelineno-19-16></a>
</span><span id=__span-19-17><a id=__codelineno-19-17 name=__codelineno-19-17 href=#__codelineno-19-17></a><span class=c1># Avoid - unnecessary sequential execution</span>
</span><span id=__span-19-18><a id=__codelineno-19-18 name=__codelineno-19-18 href=#__codelineno-19-18></a><span class=nt>tasks</span><span class=p>:</span>
</span><span id=__span-19-19><a id=__codelineno-19-19 name=__codelineno-19-19 href=#__codelineno-19-19></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">step1</span>
</span><span id=__span-19-20><a id=__codelineno-19-20 name=__codelineno-19-20 href=#__codelineno-19-20></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">researcher</span>
</span><span id=__span-19-21><a id=__codelineno-19-21 name=__codelineno-19-21 href=#__codelineno-19-21></a><span class=w>    </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Research</span><span class=nv> </span><span class=s>A&quot;</span>
</span><span id=__span-19-22><a id=__codelineno-19-22 name=__codelineno-19-22 href=#__codelineno-19-22></a>
</span><span id=__span-19-23><a id=__codelineno-19-23 name=__codelineno-19-23 href=#__codelineno-19-23></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">step2</span>
</span><span id=__span-19-24><a id=__codelineno-19-24 name=__codelineno-19-24 href=#__codelineno-19-24></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">researcher</span>
</span><span id=__span-19-25><a id=__codelineno-19-25 name=__codelineno-19-25 href=#__codelineno-19-25></a><span class=w>    </span><span class=nt>deps</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>step1</span><span class="p p-Indicator">]</span><span class=w>  </span><span class=c1># Only depends if actually needs step1 output</span>
</span><span id=__span-19-26><a id=__codelineno-19-26 name=__codelineno-19-26 href=#__codelineno-19-26></a><span class=w>    </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Research</span><span class=nv> </span><span class=s>B&quot;</span><span class=w>  </span><span class=c1># If independent, remove deps</span>
</span></code></pre></div> <h3 id=2-set-appropriate-max_parallel>2. Set Appropriate max_parallel<a class=headerlink href=#2-set-appropriate-max_parallel title="Permanent link">&para;</a></h3> <p>Balance speed and resource usage:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-20-1><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=c1># For I/O-bound tasks (API calls, web research)</span>
</span><span id=__span-20-2><a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a><span class=nt>runtime</span><span class=p>:</span>
</span><span id=__span-20-3><a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a><span class=w>  </span><span class=nt>max_parallel</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">10</span><span class=w>  </span><span class=c1># Higher parallelism acceptable</span>
</span><span id=__span-20-4><a id=__codelineno-20-4 name=__codelineno-20-4 href=#__codelineno-20-4></a>
</span><span id=__span-20-5><a id=__codelineno-20-5 name=__codelineno-20-5 href=#__codelineno-20-5></a><span class=c1># For compute-intensive tasks</span>
</span><span id=__span-20-6><a id=__codelineno-20-6 name=__codelineno-20-6 href=#__codelineno-20-6></a><span class=nt>runtime</span><span class=p>:</span>
</span><span id=__span-20-7><a id=__codelineno-20-7 name=__codelineno-20-7 href=#__codelineno-20-7></a><span class=w>  </span><span class=nt>max_parallel</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">3</span><span class=w>   </span><span class=c1># Lower to avoid overload</span>
</span></code></pre></div> <h3 id=3-use-descriptive-task-ids>3. Use Descriptive Task IDs<a class=headerlink href=#3-use-descriptive-task-ids title="Permanent link">&para;</a></h3> <p>Make task IDs meaningful:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-21-1><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=c1># Good - clear purpose</span>
</span><span id=__span-21-2><a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a><span class=nt>tasks</span><span class=p>:</span>
</span><span id=__span-21-3><a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">market_research</span>
</span><span id=__span-21-4><a id=__codelineno-21-4 name=__codelineno-21-4 href=#__codelineno-21-4></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">competitor_analysis</span>
</span><span id=__span-21-5><a id=__codelineno-21-5 name=__codelineno-21-5 href=#__codelineno-21-5></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">swot_synthesis</span>
</span><span id=__span-21-6><a id=__codelineno-21-6 name=__codelineno-21-6 href=#__codelineno-21-6></a>
</span><span id=__span-21-7><a id=__codelineno-21-7 name=__codelineno-21-7 href=#__codelineno-21-7></a><span class=c1># Avoid - generic IDs</span>
</span><span id=__span-21-8><a id=__codelineno-21-8 name=__codelineno-21-8 href=#__codelineno-21-8></a><span class=nt>tasks</span><span class=p>:</span>
</span><span id=__span-21-9><a id=__codelineno-21-9 name=__codelineno-21-9 href=#__codelineno-21-9></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">task1</span>
</span><span id=__span-21-10><a id=__codelineno-21-10 name=__codelineno-21-10 href=#__codelineno-21-10></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">task2</span>
</span><span id=__span-21-11><a id=__codelineno-21-11 name=__codelineno-21-11 href=#__codelineno-21-11></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">task3</span>
</span></code></pre></div> <h3 id=4-validate-dag-structure>4. Validate DAG Structure<a class=headerlink href=#4-validate-dag-structure title="Permanent link">&para;</a></h3> <p>Ensure no circular dependencies:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-22-1><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a><span class=c1># Invalid - circular dependency</span>
</span><span id=__span-22-2><a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a><span class=nt>tasks</span><span class=p>:</span>
</span><span id=__span-22-3><a id=__codelineno-22-3 name=__codelineno-22-3 href=#__codelineno-22-3></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">A</span>
</span><span id=__span-22-4><a id=__codelineno-22-4 name=__codelineno-22-4 href=#__codelineno-22-4></a><span class=w>    </span><span class=nt>deps</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>B</span><span class="p p-Indicator">]</span>
</span><span id=__span-22-5><a id=__codelineno-22-5 name=__codelineno-22-5 href=#__codelineno-22-5></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">B</span>
</span><span id=__span-22-6><a id=__codelineno-22-6 name=__codelineno-22-6 href=#__codelineno-22-6></a><span class=w>    </span><span class=nt>deps</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>A</span><span class="p p-Indicator">]</span><span class=w>  </span><span class=c1># Error: cycle detected</span>
</span></code></pre></div> <p>Strands validates DAG structure at load time.</p> <h3 id=5-manage-context-size>5. Manage Context Size<a class=headerlink href=#5-manage-context-size title="Permanent link">&para;</a></h3> <p>Truncate large task outputs when passing to dependent tasks:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-23-1><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a><span class=nt>tasks</span><span class=p>:</span>
</span><span id=__span-23-2><a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">large_research</span>
</span><span id=__span-23-3><a id=__codelineno-23-3 name=__codelineno-23-3 href=#__codelineno-23-3></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">researcher</span>
</span><span id=__span-23-4><a id=__codelineno-23-4 name=__codelineno-23-4 href=#__codelineno-23-4></a><span class=w>    </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Comprehensive</span><span class=nv> </span><span class=s>research</span><span class=nv> </span><span class=s>on</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>topic</span><span class=nv> </span><span class=s>}}&quot;</span>
</span><span id=__span-23-5><a id=__codelineno-23-5 name=__codelineno-23-5 href=#__codelineno-23-5></a>
</span><span id=__span-23-6><a id=__codelineno-23-6 name=__codelineno-23-6 href=#__codelineno-23-6></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">summary</span>
</span><span id=__span-23-7><a id=__codelineno-23-7 name=__codelineno-23-7 href=#__codelineno-23-7></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">writer</span>
</span><span id=__span-23-8><a id=__codelineno-23-8 name=__codelineno-23-8 href=#__codelineno-23-8></a><span class=w>    </span><span class=nt>deps</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>large_research</span><span class="p p-Indicator">]</span>
</span><span id=__span-23-9><a id=__codelineno-23-9 name=__codelineno-23-9 href=#__codelineno-23-9></a><span class=w>    </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">|</span>
</span><span id=__span-23-10><a id=__codelineno-23-10 name=__codelineno-23-10 href=#__codelineno-23-10></a><span class=w>      </span><span class=no>Research (truncated):</span>
</span><span id=__span-23-11><a id=__codelineno-23-11 name=__codelineno-23-11 href=#__codelineno-23-11></a><span class=w>      </span><span class=no>{{ tasks.large_research.response | truncate(500) }}</span>
</span><span id=__span-23-12><a id=__codelineno-23-12 name=__codelineno-23-12 href=#__codelineno-23-12></a>
</span><span id=__span-23-13><a id=__codelineno-23-13 name=__codelineno-23-13 href=#__codelineno-23-13></a><span class=w>      </span><span class=no>Summarize key points.</span>
</span></code></pre></div> <h2 id=common-patterns>Common Patterns<a class=headerlink href=#common-patterns title="Permanent link">&para;</a></h2> <h3 id=linear-pipeline-sequential>Linear Pipeline (Sequential)<a class=headerlink href=#linear-pipeline-sequential title="Permanent link">&para;</a></h3> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-24-1><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a><span class=nt>tasks</span><span class=p>:</span>
</span><span id=__span-24-2><a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">collect</span>
</span><span id=__span-24-3><a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">researcher</span>
</span><span id=__span-24-4><a id=__codelineno-24-4 name=__codelineno-24-4 href=#__codelineno-24-4></a><span class=w>    </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Collect</span><span class=nv> </span><span class=s>data&quot;</span>
</span><span id=__span-24-5><a id=__codelineno-24-5 name=__codelineno-24-5 href=#__codelineno-24-5></a>
</span><span id=__span-24-6><a id=__codelineno-24-6 name=__codelineno-24-6 href=#__codelineno-24-6></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">analyze</span>
</span><span id=__span-24-7><a id=__codelineno-24-7 name=__codelineno-24-7 href=#__codelineno-24-7></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">analyst</span>
</span><span id=__span-24-8><a id=__codelineno-24-8 name=__codelineno-24-8 href=#__codelineno-24-8></a><span class=w>    </span><span class=nt>deps</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>collect</span><span class="p p-Indicator">]</span>
</span><span id=__span-24-9><a id=__codelineno-24-9 name=__codelineno-24-9 href=#__codelineno-24-9></a><span class=w>    </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Analyze:</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>tasks.collect.response</span><span class=nv> </span><span class=s>}}&quot;</span>
</span><span id=__span-24-10><a id=__codelineno-24-10 name=__codelineno-24-10 href=#__codelineno-24-10></a>
</span><span id=__span-24-11><a id=__codelineno-24-11 name=__codelineno-24-11 href=#__codelineno-24-11></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">recommend</span>
</span><span id=__span-24-12><a id=__codelineno-24-12 name=__codelineno-24-12 href=#__codelineno-24-12></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">advisor</span>
</span><span id=__span-24-13><a id=__codelineno-24-13 name=__codelineno-24-13 href=#__codelineno-24-13></a><span class=w>    </span><span class=nt>deps</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>analyze</span><span class="p p-Indicator">]</span>
</span><span id=__span-24-14><a id=__codelineno-24-14 name=__codelineno-24-14 href=#__codelineno-24-14></a><span class=w>    </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Recommend:</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>tasks.analyze.response</span><span class=nv> </span><span class=s>}}&quot;</span>
</span></code></pre></div> <h3 id=diamond-pattern>Diamond Pattern<a class=headerlink href=#diamond-pattern title="Permanent link">&para;</a></h3> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-25-1><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a><span class=nt>tasks</span><span class=p>:</span>
</span><span id=__span-25-2><a id=__codelineno-25-2 name=__codelineno-25-2 href=#__codelineno-25-2></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">source</span>
</span><span id=__span-25-3><a id=__codelineno-25-3 name=__codelineno-25-3 href=#__codelineno-25-3></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">researcher</span>
</span><span id=__span-25-4><a id=__codelineno-25-4 name=__codelineno-25-4 href=#__codelineno-25-4></a><span class=w>    </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Research</span><span class=nv> </span><span class=s>{{</span><span class=nv> </span><span class=s>topic</span><span class=nv> </span><span class=s>}}&quot;</span>
</span><span id=__span-25-5><a id=__codelineno-25-5 name=__codelineno-25-5 href=#__codelineno-25-5></a>
</span><span id=__span-25-6><a id=__codelineno-25-6 name=__codelineno-25-6 href=#__codelineno-25-6></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">left</span>
</span><span id=__span-25-7><a id=__codelineno-25-7 name=__codelineno-25-7 href=#__codelineno-25-7></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">analyst</span>
</span><span id=__span-25-8><a id=__codelineno-25-8 name=__codelineno-25-8 href=#__codelineno-25-8></a><span class=w>    </span><span class=nt>deps</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>source</span><span class="p p-Indicator">]</span>
</span><span id=__span-25-9><a id=__codelineno-25-9 name=__codelineno-25-9 href=#__codelineno-25-9></a><span class=w>    </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Left</span><span class=nv> </span><span class=s>analysis&quot;</span>
</span><span id=__span-25-10><a id=__codelineno-25-10 name=__codelineno-25-10 href=#__codelineno-25-10></a>
</span><span id=__span-25-11><a id=__codelineno-25-11 name=__codelineno-25-11 href=#__codelineno-25-11></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">right</span>
</span><span id=__span-25-12><a id=__codelineno-25-12 name=__codelineno-25-12 href=#__codelineno-25-12></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">analyst</span>
</span><span id=__span-25-13><a id=__codelineno-25-13 name=__codelineno-25-13 href=#__codelineno-25-13></a><span class=w>    </span><span class=nt>deps</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>source</span><span class="p p-Indicator">]</span>
</span><span id=__span-25-14><a id=__codelineno-25-14 name=__codelineno-25-14 href=#__codelineno-25-14></a><span class=w>    </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Right</span><span class=nv> </span><span class=s>analysis&quot;</span>
</span><span id=__span-25-15><a id=__codelineno-25-15 name=__codelineno-25-15 href=#__codelineno-25-15></a>
</span><span id=__span-25-16><a id=__codelineno-25-16 name=__codelineno-25-16 href=#__codelineno-25-16></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">merge</span>
</span><span id=__span-25-17><a id=__codelineno-25-17 name=__codelineno-25-17 href=#__codelineno-25-17></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">writer</span>
</span><span id=__span-25-18><a id=__codelineno-25-18 name=__codelineno-25-18 href=#__codelineno-25-18></a><span class=w>    </span><span class=nt>deps</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>left</span><span class="p p-Indicator">,</span><span class=w> </span><span class=nv>right</span><span class="p p-Indicator">]</span>
</span><span id=__span-25-19><a id=__codelineno-25-19 name=__codelineno-25-19 href=#__codelineno-25-19></a><span class=w>    </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Merge</span><span class=nv> </span><span class=s>both</span><span class=nv> </span><span class=s>analyses&quot;</span>
</span></code></pre></div> <h3 id=multi-stage-pipeline>Multi-Stage Pipeline<a class=headerlink href=#multi-stage-pipeline title="Permanent link">&para;</a></h3> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-26-1><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a><span class=nt>tasks</span><span class=p>:</span>
</span><span id=__span-26-2><a id=__codelineno-26-2 name=__codelineno-26-2 href=#__codelineno-26-2></a><span class=w>  </span><span class=c1># Stage 1: Research</span>
</span><span id=__span-26-3><a id=__codelineno-26-3 name=__codelineno-26-3 href=#__codelineno-26-3></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">research1</span>
</span><span id=__span-26-4><a id=__codelineno-26-4 name=__codelineno-26-4 href=#__codelineno-26-4></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">researcher</span>
</span><span id=__span-26-5><a id=__codelineno-26-5 name=__codelineno-26-5 href=#__codelineno-26-5></a><span class=w>    </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Research</span><span class=nv> </span><span class=s>aspect</span><span class=nv> </span><span class=s>1&quot;</span>
</span><span id=__span-26-6><a id=__codelineno-26-6 name=__codelineno-26-6 href=#__codelineno-26-6></a>
</span><span id=__span-26-7><a id=__codelineno-26-7 name=__codelineno-26-7 href=#__codelineno-26-7></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">research2</span>
</span><span id=__span-26-8><a id=__codelineno-26-8 name=__codelineno-26-8 href=#__codelineno-26-8></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">researcher</span>
</span><span id=__span-26-9><a id=__codelineno-26-9 name=__codelineno-26-9 href=#__codelineno-26-9></a><span class=w>    </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Research</span><span class=nv> </span><span class=s>aspect</span><span class=nv> </span><span class=s>2&quot;</span>
</span><span id=__span-26-10><a id=__codelineno-26-10 name=__codelineno-26-10 href=#__codelineno-26-10></a>
</span><span id=__span-26-11><a id=__codelineno-26-11 name=__codelineno-26-11 href=#__codelineno-26-11></a><span class=w>  </span><span class=c1># Stage 2: Analysis (depends on all research)</span>
</span><span id=__span-26-12><a id=__codelineno-26-12 name=__codelineno-26-12 href=#__codelineno-26-12></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">analysis1</span>
</span><span id=__span-26-13><a id=__codelineno-26-13 name=__codelineno-26-13 href=#__codelineno-26-13></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">analyst</span>
</span><span id=__span-26-14><a id=__codelineno-26-14 name=__codelineno-26-14 href=#__codelineno-26-14></a><span class=w>    </span><span class=nt>deps</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>research1</span><span class="p p-Indicator">,</span><span class=w> </span><span class=nv>research2</span><span class="p p-Indicator">]</span>
</span><span id=__span-26-15><a id=__codelineno-26-15 name=__codelineno-26-15 href=#__codelineno-26-15></a><span class=w>    </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Analyze</span><span class=nv> </span><span class=s>technical&quot;</span>
</span><span id=__span-26-16><a id=__codelineno-26-16 name=__codelineno-26-16 href=#__codelineno-26-16></a>
</span><span id=__span-26-17><a id=__codelineno-26-17 name=__codelineno-26-17 href=#__codelineno-26-17></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">analysis2</span>
</span><span id=__span-26-18><a id=__codelineno-26-18 name=__codelineno-26-18 href=#__codelineno-26-18></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">analyst</span>
</span><span id=__span-26-19><a id=__codelineno-26-19 name=__codelineno-26-19 href=#__codelineno-26-19></a><span class=w>    </span><span class=nt>deps</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>research1</span><span class="p p-Indicator">,</span><span class=w> </span><span class=nv>research2</span><span class="p p-Indicator">]</span>
</span><span id=__span-26-20><a id=__codelineno-26-20 name=__codelineno-26-20 href=#__codelineno-26-20></a><span class=w>    </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Analyze</span><span class=nv> </span><span class=s>business&quot;</span>
</span><span id=__span-26-21><a id=__codelineno-26-21 name=__codelineno-26-21 href=#__codelineno-26-21></a>
</span><span id=__span-26-22><a id=__codelineno-26-22 name=__codelineno-26-22 href=#__codelineno-26-22></a><span class=w>  </span><span class=c1># Stage 3: Synthesis (depends on all analysis)</span>
</span><span id=__span-26-23><a id=__codelineno-26-23 name=__codelineno-26-23 href=#__codelineno-26-23></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">synthesis</span>
</span><span id=__span-26-24><a id=__codelineno-26-24 name=__codelineno-26-24 href=#__codelineno-26-24></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">writer</span>
</span><span id=__span-26-25><a id=__codelineno-26-25 name=__codelineno-26-25 href=#__codelineno-26-25></a><span class=w>    </span><span class=nt>deps</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>analysis1</span><span class="p p-Indicator">,</span><span class=w> </span><span class=nv>analysis2</span><span class="p p-Indicator">]</span>
</span><span id=__span-26-26><a id=__codelineno-26-26 name=__codelineno-26-26 href=#__codelineno-26-26></a><span class=w>    </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Synthesize</span><span class=nv> </span><span class=s>all</span><span class=nv> </span><span class=s>findings&quot;</span>
</span></code></pre></div> <h2 id=performance-considerations>Performance Considerations<a class=headerlink href=#performance-considerations title="Permanent link">&para;</a></h2> <h3 id=task-scheduling-overhead>Task Scheduling Overhead<a class=headerlink href=#task-scheduling-overhead title="Permanent link">&para;</a></h3> <p>Workflow pattern has scheduling overhead for dependency resolution:</p> <ul> <li>Small workflows (&lt; 5 tasks): Minimal overhead</li> <li>Large workflows (&gt; 20 tasks): ~100-200ms scheduling overhead</li> <li>Consider using Chain pattern for simple sequential workflows</li> </ul> <h3 id=agent-caching>Agent Caching<a class=headerlink href=#agent-caching title="Permanent link">&para;</a></h3> <p>Strands automatically caches agents with identical configurations:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-27-1><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a><span class=nt>agents</span><span class=p>:</span>
</span><span id=__span-27-2><a id=__codelineno-27-2 name=__codelineno-27-2 href=#__codelineno-27-2></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">researcher</span>
</span><span id=__span-27-3><a id=__codelineno-27-3 name=__codelineno-27-3 href=#__codelineno-27-3></a><span class=w>    </span><span class=nt>system</span><span class=p>:</span><span class=w> </span><span class=s>&quot;You</span><span class=nv> </span><span class=s>are</span><span class=nv> </span><span class=s>a</span><span class=nv> </span><span class=s>researcher&quot;</span>
</span><span id=__span-27-4><a id=__codelineno-27-4 name=__codelineno-27-4 href=#__codelineno-27-4></a>
</span><span id=__span-27-5><a id=__codelineno-27-5 name=__codelineno-27-5 href=#__codelineno-27-5></a><span class=nt>tasks</span><span class=p>:</span>
</span><span id=__span-27-6><a id=__codelineno-27-6 name=__codelineno-27-6 href=#__codelineno-27-6></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">task1</span>
</span><span id=__span-27-7><a id=__codelineno-27-7 name=__codelineno-27-7 href=#__codelineno-27-7></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">researcher</span><span class=w>  </span><span class=c1># Agent built here</span>
</span><span id=__span-27-8><a id=__codelineno-27-8 name=__codelineno-27-8 href=#__codelineno-27-8></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">task2</span>
</span><span id=__span-27-9><a id=__codelineno-27-9 name=__codelineno-27-9 href=#__codelineno-27-9></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">researcher</span><span class=w>  </span><span class=c1># Cached - no rebuild</span>
</span><span id=__span-27-10><a id=__codelineno-27-10 name=__codelineno-27-10 href=#__codelineno-27-10></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">task3</span>
</span><span id=__span-27-11><a id=__codelineno-27-11 name=__codelineno-27-11 href=#__codelineno-27-11></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">researcher</span><span class=w>  </span><span class=c1># Cached - no rebuild</span>
</span></code></pre></div> <p>This provides ~90% overhead reduction for repeated agent use.</p> <h3 id=optimal-parallelism>Optimal Parallelism<a class=headerlink href=#optimal-parallelism title="Permanent link">&para;</a></h3> <p>The workflow executor efficiently schedules tasks:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-28-1><a id=__codelineno-28-1 name=__codelineno-28-1 href=#__codelineno-28-1></a><span class=c1># Optimal: 3 parallel branches, max_parallel=3</span>
</span><span id=__span-28-2><a id=__codelineno-28-2 name=__codelineno-28-2 href=#__codelineno-28-2></a><span class=nt>runtime</span><span class=p>:</span>
</span><span id=__span-28-3><a id=__codelineno-28-3 name=__codelineno-28-3 href=#__codelineno-28-3></a><span class=w>  </span><span class=nt>max_parallel</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
</span><span id=__span-28-4><a id=__codelineno-28-4 name=__codelineno-28-4 href=#__codelineno-28-4></a>
</span><span id=__span-28-5><a id=__codelineno-28-5 name=__codelineno-28-5 href=#__codelineno-28-5></a><span class=nt>tasks</span><span class=p>:</span>
</span><span id=__span-28-6><a id=__codelineno-28-6 name=__codelineno-28-6 href=#__codelineno-28-6></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">source</span>
</span><span id=__span-28-7><a id=__codelineno-28-7 name=__codelineno-28-7 href=#__codelineno-28-7></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">researcher</span>
</span><span id=__span-28-8><a id=__codelineno-28-8 name=__codelineno-28-8 href=#__codelineno-28-8></a><span class=w>    </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Research&quot;</span>
</span><span id=__span-28-9><a id=__codelineno-28-9 name=__codelineno-28-9 href=#__codelineno-28-9></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">branch1</span>
</span><span id=__span-28-10><a id=__codelineno-28-10 name=__codelineno-28-10 href=#__codelineno-28-10></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">analyst</span>
</span><span id=__span-28-11><a id=__codelineno-28-11 name=__codelineno-28-11 href=#__codelineno-28-11></a><span class=w>    </span><span class=nt>deps</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>source</span><span class="p p-Indicator">]</span>
</span><span id=__span-28-12><a id=__codelineno-28-12 name=__codelineno-28-12 href=#__codelineno-28-12></a><span class=w>    </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Branch</span><span class=nv> </span><span class=s>1&quot;</span>
</span><span id=__span-28-13><a id=__codelineno-28-13 name=__codelineno-28-13 href=#__codelineno-28-13></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">branch2</span>
</span><span id=__span-28-14><a id=__codelineno-28-14 name=__codelineno-28-14 href=#__codelineno-28-14></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">analyst</span>
</span><span id=__span-28-15><a id=__codelineno-28-15 name=__codelineno-28-15 href=#__codelineno-28-15></a><span class=w>    </span><span class=nt>deps</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>source</span><span class="p p-Indicator">]</span>
</span><span id=__span-28-16><a id=__codelineno-28-16 name=__codelineno-28-16 href=#__codelineno-28-16></a><span class=w>    </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Branch</span><span class=nv> </span><span class=s>2&quot;</span>
</span><span id=__span-28-17><a id=__codelineno-28-17 name=__codelineno-28-17 href=#__codelineno-28-17></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">branch3</span>
</span><span id=__span-28-18><a id=__codelineno-28-18 name=__codelineno-28-18 href=#__codelineno-28-18></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">analyst</span>
</span><span id=__span-28-19><a id=__codelineno-28-19 name=__codelineno-28-19 href=#__codelineno-28-19></a><span class=w>    </span><span class=nt>deps</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>source</span><span class="p p-Indicator">]</span>
</span><span id=__span-28-20><a id=__codelineno-28-20 name=__codelineno-28-20 href=#__codelineno-28-20></a><span class=w>    </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Branch</span><span class=nv> </span><span class=s>3&quot;</span>
</span></code></pre></div> <p>All three branches execute concurrently after source completes.</p> <h2 id=troubleshooting>Troubleshooting<a class=headerlink href=#troubleshooting title="Permanent link">&para;</a></h2> <h3 id=workflow-not-completing>Workflow Not Completing<a class=headerlink href=#workflow-not-completing title="Permanent link">&para;</a></h3> <p>Check for circular dependencies:</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-29-1><a id=__codelineno-29-1 name=__codelineno-29-1 href=#__codelineno-29-1></a>strands<span class=w> </span>validate<span class=w> </span>workflow.yaml
</span></code></pre></div> <p>Look for: <div class="language-text highlight"><pre><span></span><code><span id=__span-30-1><a id=__codelineno-30-1 name=__codelineno-30-1 href=#__codelineno-30-1></a>Validation Error: Circular dependency detected in workflow DAG
</span></code></pre></div></p> <h3 id=tasks-not-running-in-parallel>Tasks Not Running in Parallel<a class=headerlink href=#tasks-not-running-in-parallel title="Permanent link">&para;</a></h3> <p>Verify dependencies are correct:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-31-1><a id=__codelineno-31-1 name=__codelineno-31-1 href=#__codelineno-31-1></a><span class=c1># Check that tasks don&#39;t have unnecessary deps</span>
</span><span id=__span-31-2><a id=__codelineno-31-2 name=__codelineno-31-2 href=#__codelineno-31-2></a><span class=nt>tasks</span><span class=p>:</span>
</span><span id=__span-31-3><a id=__codelineno-31-3 name=__codelineno-31-3 href=#__codelineno-31-3></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">task1</span>
</span><span id=__span-31-4><a id=__codelineno-31-4 name=__codelineno-31-4 href=#__codelineno-31-4></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">researcher</span>
</span><span id=__span-31-5><a id=__codelineno-31-5 name=__codelineno-31-5 href=#__codelineno-31-5></a><span class=w>    </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Independent</span><span class=nv> </span><span class=s>task</span><span class=nv> </span><span class=s>1&quot;</span>
</span><span id=__span-31-6><a id=__codelineno-31-6 name=__codelineno-31-6 href=#__codelineno-31-6></a>
</span><span id=__span-31-7><a id=__codelineno-31-7 name=__codelineno-31-7 href=#__codelineno-31-7></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">task2</span>
</span><span id=__span-31-8><a id=__codelineno-31-8 name=__codelineno-31-8 href=#__codelineno-31-8></a><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">researcher</span>
</span><span id=__span-31-9><a id=__codelineno-31-9 name=__codelineno-31-9 href=#__codelineno-31-9></a><span class=w>    </span><span class=c1># No deps = can run parallel with task1</span>
</span><span id=__span-31-10><a id=__codelineno-31-10 name=__codelineno-31-10 href=#__codelineno-31-10></a><span class=w>    </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Independent</span><span class=nv> </span><span class=s>task</span><span class=nv> </span><span class=s>2&quot;</span>
</span></code></pre></div> <p>Enable debug logging:</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-32-1><a id=__codelineno-32-1 name=__codelineno-32-1 href=#__codelineno-32-1></a>strands<span class=w> </span>run<span class=w> </span>workflow.yaml<span class=w> </span>--debug<span class=w> </span>--verbose
</span></code></pre></div> <h3 id=budget-exceeded>Budget Exceeded<a class=headerlink href=#budget-exceeded title="Permanent link">&para;</a></h3> <p>Increase budget limits or reduce task count:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-33-1><a id=__codelineno-33-1 name=__codelineno-33-1 href=#__codelineno-33-1></a><span class=nt>runtime</span><span class=p>:</span>
</span><span id=__span-33-2><a id=__codelineno-33-2 name=__codelineno-33-2 href=#__codelineno-33-2></a><span class=w>  </span><span class=nt>budgets</span><span class=p>:</span>
</span><span id=__span-33-3><a id=__codelineno-33-3 name=__codelineno-33-3 href=#__codelineno-33-3></a><span class=w>    </span><span class=nt>max_tasks</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">30</span><span class=w>        </span><span class=c1># Increase from default</span>
</span><span id=__span-33-4><a id=__codelineno-33-4 name=__codelineno-33-4 href=#__codelineno-33-4></a><span class=w>    </span><span class=nt>max_tokens</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">200000</span><span class=w>   </span><span class=c1># Increase token budget</span>
</span></code></pre></div> <h3 id=task-failures>Task Failures<a class=headerlink href=#task-failures title="Permanent link">&para;</a></h3> <p>Check task-level errors:</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-34-1><a id=__codelineno-34-1 name=__codelineno-34-1 href=#__codelineno-34-1></a>strands<span class=w> </span>run<span class=w> </span>workflow.yaml<span class=w> </span>--debug<span class=w> </span>--verbose
</span></code></pre></div> <p>Look for: <div class="language-text highlight"><pre><span></span><code><span id=__span-35-1><a id=__codelineno-35-1 name=__codelineno-35-1 href=#__codelineno-35-1></a>Task &#39;task_id&#39; failed: &lt;error message&gt;
</span><span id=__span-35-2><a id=__codelineno-35-2 name=__codelineno-35-2 href=#__codelineno-35-2></a>Dependent tasks [&#39;dep1&#39;, &#39;dep2&#39;] will not execute
</span></code></pre></div></p> <h2 id=workflow-vs-other-patterns>Workflow vs. Other Patterns<a class=headerlink href=#workflow-vs-other-patterns title="Permanent link">&para;</a></h2> <h3 id=workflow-vs-chain>Workflow vs. Chain<a class=headerlink href=#workflow-vs-chain title="Permanent link">&para;</a></h3> <p>Use Workflow when tasks can run in parallel:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-36-1><a id=__codelineno-36-1 name=__codelineno-36-1 href=#__codelineno-36-1></a><span class=c1># Chain: 30 seconds total (sequential)</span>
</span><span id=__span-36-2><a id=__codelineno-36-2 name=__codelineno-36-2 href=#__codelineno-36-2></a><span class=nt>pattern</span><span class=p>:</span>
</span><span id=__span-36-3><a id=__codelineno-36-3 name=__codelineno-36-3 href=#__codelineno-36-3></a><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">chain</span>
</span><span id=__span-36-4><a id=__codelineno-36-4 name=__codelineno-36-4 href=#__codelineno-36-4></a><span class=w>  </span><span class=nt>config</span><span class=p>:</span>
</span><span id=__span-36-5><a id=__codelineno-36-5 name=__codelineno-36-5 href=#__codelineno-36-5></a><span class=w>    </span><span class=nt>steps</span><span class=p>:</span>
</span><span id=__span-36-6><a id=__codelineno-36-6 name=__codelineno-36-6 href=#__codelineno-36-6></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>agent_id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">researcher</span>
</span><span id=__span-36-7><a id=__codelineno-36-7 name=__codelineno-36-7 href=#__codelineno-36-7></a><span class=w>        </span><span class=nt>prompt</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Research</span><span class=nv> </span><span class=s>A&quot;</span><span class=w>  </span><span class=c1># 10s</span>
</span><span id=__span-36-8><a id=__codelineno-36-8 name=__codelineno-36-8 href=#__codelineno-36-8></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>agent_id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">researcher</span>
</span><span id=__span-36-9><a id=__codelineno-36-9 name=__codelineno-36-9 href=#__codelineno-36-9></a><span class=w>        </span><span class=nt>prompt</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Research</span><span class=nv> </span><span class=s>B&quot;</span><span class=w>  </span><span class=c1># 10s</span>
</span><span id=__span-36-10><a id=__codelineno-36-10 name=__codelineno-36-10 href=#__codelineno-36-10></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>agent_id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">researcher</span>
</span><span id=__span-36-11><a id=__codelineno-36-11 name=__codelineno-36-11 href=#__codelineno-36-11></a><span class=w>        </span><span class=nt>prompt</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Research</span><span class=nv> </span><span class=s>C&quot;</span><span class=w>  </span><span class=c1># 10s</span>
</span><span id=__span-36-12><a id=__codelineno-36-12 name=__codelineno-36-12 href=#__codelineno-36-12></a>
</span><span id=__span-36-13><a id=__codelineno-36-13 name=__codelineno-36-13 href=#__codelineno-36-13></a><span class=c1># Workflow: 10 seconds total (parallel)</span>
</span><span id=__span-36-14><a id=__codelineno-36-14 name=__codelineno-36-14 href=#__codelineno-36-14></a><span class=nt>pattern</span><span class=p>:</span>
</span><span id=__span-36-15><a id=__codelineno-36-15 name=__codelineno-36-15 href=#__codelineno-36-15></a><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">workflow</span>
</span><span id=__span-36-16><a id=__codelineno-36-16 name=__codelineno-36-16 href=#__codelineno-36-16></a><span class=w>  </span><span class=nt>config</span><span class=p>:</span>
</span><span id=__span-36-17><a id=__codelineno-36-17 name=__codelineno-36-17 href=#__codelineno-36-17></a><span class=w>    </span><span class=nt>tasks</span><span class=p>:</span>
</span><span id=__span-36-18><a id=__codelineno-36-18 name=__codelineno-36-18 href=#__codelineno-36-18></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">research_a</span>
</span><span id=__span-36-19><a id=__codelineno-36-19 name=__codelineno-36-19 href=#__codelineno-36-19></a><span class=w>        </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">researcher</span>
</span><span id=__span-36-20><a id=__codelineno-36-20 name=__codelineno-36-20 href=#__codelineno-36-20></a><span class=w>        </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Research</span><span class=nv> </span><span class=s>A&quot;</span><span class=w>  </span><span class=c1># 10s</span>
</span><span id=__span-36-21><a id=__codelineno-36-21 name=__codelineno-36-21 href=#__codelineno-36-21></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">research_b</span>
</span><span id=__span-36-22><a id=__codelineno-36-22 name=__codelineno-36-22 href=#__codelineno-36-22></a><span class=w>        </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">researcher</span>
</span><span id=__span-36-23><a id=__codelineno-36-23 name=__codelineno-36-23 href=#__codelineno-36-23></a><span class=w>        </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Research</span><span class=nv> </span><span class=s>B&quot;</span><span class=w>  </span><span class=c1># 10s (concurrent)</span>
</span><span id=__span-36-24><a id=__codelineno-36-24 name=__codelineno-36-24 href=#__codelineno-36-24></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">research_c</span>
</span><span id=__span-36-25><a id=__codelineno-36-25 name=__codelineno-36-25 href=#__codelineno-36-25></a><span class=w>        </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">researcher</span>
</span><span id=__span-36-26><a id=__codelineno-36-26 name=__codelineno-36-26 href=#__codelineno-36-26></a><span class=w>        </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Research</span><span class=nv> </span><span class=s>C&quot;</span><span class=w>  </span><span class=c1># 10s (concurrent)</span>
</span></code></pre></div> <h3 id=workflow-vs-parallel>Workflow vs. Parallel<a class=headerlink href=#workflow-vs-parallel title="Permanent link">&para;</a></h3> <p>Workflow supports dependencies, Parallel does not:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-37-1><a id=__codelineno-37-1 name=__codelineno-37-1 href=#__codelineno-37-1></a><span class=c1># Workflow: Tasks can depend on each other</span>
</span><span id=__span-37-2><a id=__codelineno-37-2 name=__codelineno-37-2 href=#__codelineno-37-2></a><span class=nt>pattern</span><span class=p>:</span>
</span><span id=__span-37-3><a id=__codelineno-37-3 name=__codelineno-37-3 href=#__codelineno-37-3></a><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">workflow</span>
</span><span id=__span-37-4><a id=__codelineno-37-4 name=__codelineno-37-4 href=#__codelineno-37-4></a><span class=w>  </span><span class=nt>config</span><span class=p>:</span>
</span><span id=__span-37-5><a id=__codelineno-37-5 name=__codelineno-37-5 href=#__codelineno-37-5></a><span class=w>    </span><span class=nt>tasks</span><span class=p>:</span>
</span><span id=__span-37-6><a id=__codelineno-37-6 name=__codelineno-37-6 href=#__codelineno-37-6></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">source</span>
</span><span id=__span-37-7><a id=__codelineno-37-7 name=__codelineno-37-7 href=#__codelineno-37-7></a><span class=w>        </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">researcher</span>
</span><span id=__span-37-8><a id=__codelineno-37-8 name=__codelineno-37-8 href=#__codelineno-37-8></a><span class=w>        </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Research&quot;</span>
</span><span id=__span-37-9><a id=__codelineno-37-9 name=__codelineno-37-9 href=#__codelineno-37-9></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">analysis</span>
</span><span id=__span-37-10><a id=__codelineno-37-10 name=__codelineno-37-10 href=#__codelineno-37-10></a><span class=w>        </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">analyst</span>
</span><span id=__span-37-11><a id=__codelineno-37-11 name=__codelineno-37-11 href=#__codelineno-37-11></a><span class=w>        </span><span class=nt>deps</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>source</span><span class="p p-Indicator">]</span><span class=w>  </span><span class=c1># Waits for source</span>
</span><span id=__span-37-12><a id=__codelineno-37-12 name=__codelineno-37-12 href=#__codelineno-37-12></a><span class=w>        </span><span class=nt>input</span><span class=p>:</span><span class=w> </span><span class=s>&quot;{{</span><span class=nv> </span><span class=s>tasks.source.response</span><span class=nv> </span><span class=s>}}&quot;</span>
</span><span id=__span-37-13><a id=__codelineno-37-13 name=__codelineno-37-13 href=#__codelineno-37-13></a>
</span><span id=__span-37-14><a id=__codelineno-37-14 name=__codelineno-37-14 href=#__codelineno-37-14></a><span class=c1># Parallel: All branches independent</span>
</span><span id=__span-37-15><a id=__codelineno-37-15 name=__codelineno-37-15 href=#__codelineno-37-15></a><span class=nt>pattern</span><span class=p>:</span>
</span><span id=__span-37-16><a id=__codelineno-37-16 name=__codelineno-37-16 href=#__codelineno-37-16></a><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">parallel</span>
</span><span id=__span-37-17><a id=__codelineno-37-17 name=__codelineno-37-17 href=#__codelineno-37-17></a><span class=w>  </span><span class=nt>config</span><span class=p>:</span>
</span><span id=__span-37-18><a id=__codelineno-37-18 name=__codelineno-37-18 href=#__codelineno-37-18></a><span class=w>    </span><span class=nt>branches</span><span class=p>:</span>
</span><span id=__span-37-19><a id=__codelineno-37-19 name=__codelineno-37-19 href=#__codelineno-37-19></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">branch1</span>
</span><span id=__span-37-20><a id=__codelineno-37-20 name=__codelineno-37-20 href=#__codelineno-37-20></a><span class=w>        </span><span class=nt>steps</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>...</span><span class="p p-Indicator">]</span><span class=w>  </span><span class=c1># No dependencies between branches</span>
</span><span id=__span-37-21><a id=__codelineno-37-21 name=__codelineno-37-21 href=#__codelineno-37-21></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">branch2</span>
</span><span id=__span-37-22><a id=__codelineno-37-22 name=__codelineno-37-22 href=#__codelineno-37-22></a><span class=w>        </span><span class=nt>steps</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>...</span><span class="p p-Indicator">]</span>
</span></code></pre></div> <p>Use Parallel for simpler scenarios with no inter-branch dependencies.</p> <h2 id=examples>Examples<a class=headerlink href=#examples title="Permanent link">&para;</a></h2> <p>Complete examples in the repository:</p> <ul> <li><code>examples/workflow-parallel-research.yaml</code> - Fan-out/fan-in research</li> <li><code>examples/workflow-linear-dag.yaml</code> - Sequential pipeline</li> <li><code>examples/multi-task-workflow.yaml</code> - Complex multi-stage workflow</li> </ul> <h2 id=see-also>See Also<a class=headerlink href=#see-also title="Permanent link">&para;</a></h2> <ul> <li><a href=../chain/ >Chain Pattern</a> - For sequential execution</li> <li><a href=../parallel/ >Parallel Pattern</a> - For simpler concurrent execution</li> <li><a href=../graph/ >Graph Pattern</a> - For conditional control flow</li> <li><a href=../../run-workflows/ >Run Workflows</a> - Execution guide</li> <li><a href=../../context-management/ >Context Management</a> - Managing task context</li> </ul> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/ThomasRohde/strands-cli target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["content.code.copy", "content.code.annotate", "navigation.tabs", "navigation.sections", "navigation.expand", "navigation.top", "navigation.tracking", "toc.follow", "search.suggest", "search.highlight"], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "latest", "provider": "mike"}}</script> <script src=../../../assets/javascripts/bundle.f1b6f286.min.js></script> </body> </html>